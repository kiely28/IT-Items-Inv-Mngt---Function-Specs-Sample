Perfect üëç you‚Äôre now taking your ASP.NET Core MVC project to the next level ‚Äî adding a Category dropdown that gets data from the database using a stored procedure.

Let‚Äôs go step by step, clearly explained for beginners so you‚Äôll understand how and why each part works.


---

üéØ GOAL

We‚Äôll enhance your In Module (Inventory In) to include a dropdown for selecting a Category.

The category list will come from the SQL table tbl_category.

The data will be retrieved using a stored procedure.

We‚Äôll bind the data to a dropdown (<select>) in the View.



---

üóÑÔ∏è Step 1: SQL Table and Stored Procedure

üß± Create the table tbl_category

Run this SQL script in SQL Server:

CREATE TABLE tbl_category (
    CategoryID INT IDENTITY(1,1) PRIMARY KEY,
    CategoryName NVARCHAR(100)
);

-- Sample data
INSERT INTO tbl_category (CategoryName) VALUES ('Cable');
INSERT INTO tbl_category (CategoryName) VALUES ('Connector');
INSERT INTO tbl_category (CategoryName) VALUES ('Device');

‚öôÔ∏è Create the stored procedure sp_GetCategories

This procedure returns all active categories:

CREATE PROCEDURE sp_GetCategories
AS
BEGIN
    SELECT CategoryID, CategoryName FROM tbl_category ORDER BY CategoryName;
END


---

üíª Step 2: Create the Category Model

In Models folder, create a new file Category.cs:

namespace InventoryInModule.Models
{
    public class Category
    {
        public int CategoryID { get; set; }
        public string CategoryName { get; set; }
    }
}


---

üß© Step 3: Modify ApplicationDbContext.cs

Add a method to call the stored procedure.

using Microsoft.EntityFrameworkCore;
using InventoryInModule.Models;

namespace InventoryInModule.Data
{
    public class ApplicationDbContext : DbContext
    {
        public ApplicationDbContext(DbContextOptions<ApplicationDbContext> options)
            : base(options)
        {
        }

        public DbSet<InTransaction> InTransactions { get; set; }

        // Category is not a main table we track ‚Äî it‚Äôs for lookup
        public DbSet<Category> Categories { get; set; }

        // Method to call stored procedure
        public async Task<List<Category>> GetCategoriesAsync()
        {
            return await Categories.FromSqlRaw("EXEC sp_GetCategories").ToListAsync();
        }
    }
}

üß† Explanation:

FromSqlRaw("EXEC sp_GetCategories") tells EF Core to execute a stored procedure and map the result to the Category model.

ToListAsync() converts the data to a List<Category>.



---

üéÆ Step 4: Modify the Controller

Open Controllers/InController.cs
Add logic to fetch the categories for the dropdown.

using Microsoft.AspNetCore.Mvc;
using InventoryInModule.Data;
using InventoryInModule.Models;
using Microsoft.EntityFrameworkCore;

namespace InventoryInModule.Controllers
{
    public class InController : Controller
    {
        private readonly ApplicationDbContext _context;

        public InController(ApplicationDbContext context)
        {
            _context = context;
        }

        // GET: In/Create
        public async Task<IActionResult> Create()
        {
            // Load categories from stored procedure
            var categories = await _context.GetCategoriesAsync();
            ViewBag.Categories = categories;

            return View();
        }

        // POST: In/Create
        [HttpPost]
        [ValidateAntiForgeryToken]
        public async Task<IActionResult> Create(InTransaction model)
        {
            if (ModelState.IsValid)
            {
                _context.InTransactions.Add(model);
                await _context.SaveChangesAsync();
                return RedirectToAction("Index");
            }

            // reload dropdown if validation fails
            ViewBag.Categories = await _context.GetCategoriesAsync();
            return View(model);
        }
    }
}

üß† Explanation:

ViewBag.Categories temporarily stores category data for the View.

When you open the form, categories will automatically appear in the dropdown.



---

üßæ Step 5: Modify the View

Open Views/In/Create.cshtml

Add a Category dropdown above the other fields:

@model InventoryInModule.Models.InTransaction

@{
    ViewData["Title"] = "Create In Transaction";
}

<h2>Create In Transaction</h2>

<form asp-action="Create" method="post">
    <div class="form-group">
        <label>Category</label>
        <select asp-for="CategoryID" class="form-control"
                asp-items="@(new SelectList(ViewBag.Categories, "CategoryID", "CategoryName"))">
            <option value="">-- Select Category --</option>
        </select>
    </div>

    <div class="form-group">
        <label>Item Name</label>
        <input asp-for="ItemName" class="form-control" />
    </div>

    <div class="form-group">
        <label>Quantity</label>
        <input asp-for="Quantity" class="form-control" />
    </div>

    <div class="form-group">
        <label>Received Date</label>
        <input asp-for="ReceivedDate" type="date" class="form-control" />
    </div>

    <button type="submit" class="btn btn-primary mt-2">Save</button>
</form>


---

üß† Step-by-Step Summary

Step	Description	Purpose

1	Create SQL table + stored procedure	Defines where category data lives
2	Create Category model	Allows EF Core to map data from SQL
3	Add GetCategoriesAsync() in ApplicationDbContext	Fetches categories via stored procedure
4	Update controller	Passes category list to View
5	Update View	Displays dropdown using ViewBag.Categories



---

‚úÖ Final Result

When you open
üëâ /In/Create
You‚Äôll see a dropdown list that shows categories fetched from your stored procedure (sp_GetCategories).


---

Would you like me to add CategoryID as a foreign key to your InTransaction table next ‚Äî so the selected category is actually saved in your database when you submit the form?


** 0421

Perfect üëç You‚Äôre doing this the right way ‚Äî let‚Äôs now put everything together for your simple ASP.NET Core MVC ‚ÄúIn Module‚Äù project with an additional Category field, complete and beginner-friendly.

This version includes:

‚úÖ Full working code (Controller + Models + DbContext + Views)

‚úÖ Category dropdown populated from tbl_category

‚úÖ Optional stored procedure version

‚úÖ Clear explanations



---

üß© COMPLETE PROJECT STRUCTURE

InventoryInModule/
‚îÇ
‚îú‚îÄ‚îÄ Controllers/
‚îÇ   ‚îî‚îÄ‚îÄ InController.cs
‚îÇ
‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îú‚îÄ‚îÄ InTransaction.cs
‚îÇ   ‚îî‚îÄ‚îÄ Category.cs
‚îÇ
‚îú‚îÄ‚îÄ Data/
‚îÇ   ‚îî‚îÄ‚îÄ ApplicationDbContext.cs
‚îÇ
‚îú‚îÄ‚îÄ Views/
‚îÇ   ‚îî‚îÄ‚îÄ In/
‚îÇ       ‚îú‚îÄ‚îÄ Create.cshtml
‚îÇ       ‚îî‚îÄ‚îÄ Index.cshtml
‚îÇ
‚îú‚îÄ‚îÄ appsettings.json
‚îú‚îÄ‚îÄ Program.cs
‚îî‚îÄ‚îÄ InventoryInModule.csproj


---

üß± 1Ô∏è‚É£ Database Setup

Run these SQL commands in your SQL Server:

CREATE TABLE tbl_category (
    CategoryId INT IDENTITY(1,1) PRIMARY KEY,
    CategoryName NVARCHAR(100)
);

INSERT INTO tbl_category (CategoryName)
VALUES ('Cables'), ('Connectors'), ('Switches');

CREATE TABLE tbl_intransactions (
    Id INT IDENTITY(1,1) PRIMARY KEY,
    ItemName NVARCHAR(100),
    Quantity INT,
    CategoryId INT,
    FOREIGN KEY (CategoryId) REFERENCES tbl_category(CategoryId)
);


---

üóÇÔ∏è 2Ô∏è‚É£ Models

Models/Category.cs

namespace InventoryInModule.Models
{
    public class Category
    {
        public int CategoryId { get; set; }
        public string CategoryName { get; set; }
    }
}


---

Models/InTransaction.cs

using System.ComponentModel.DataAnnotations.Schema;

namespace InventoryInModule.Models
{
    public class InTransaction
    {
        public int Id { get; set; }
        public string ItemName { get; set; }
        public int Quantity { get; set; }

        // ‚úÖ Foreign key to Category
        [ForeignKey("Category")]
        public int CategoryId { get; set; }
        public Category Category { get; set; }
    }
}

üß† Explanation:
Each InTransaction record links to one Category using CategoryId.


---

üíæ 3Ô∏è‚É£ ApplicationDbContext

üóÇÔ∏è Data/ApplicationDbContext.cs

using Microsoft.EntityFrameworkCore;
using InventoryInModule.Models;

namespace InventoryInModule.Data
{
    public class ApplicationDbContext : DbContext
    {
        public ApplicationDbContext(DbContextOptions<ApplicationDbContext> options)
            : base(options)
        {
        }

        public DbSet<InTransaction> InTransactions { get; set; }
        public DbSet<Category> Categories { get; set; }  // ‚úÖ Add this
    }
}

üß† Explanation:
This connects your code models (InTransaction, Category) to the real SQL tables.


---

‚öôÔ∏è 4Ô∏è‚É£ Register Database Connection

üóÇÔ∏è In your Program.cs, add this:

using InventoryInModule.Data;
using Microsoft.EntityFrameworkCore;

var builder = WebApplication.CreateBuilder(args);

// Add MVC
builder.Services.AddControllersWithViews();

// ‚úÖ Register EF Core with SQL Server
builder.Services.AddDbContext<ApplicationDbContext>(options =>
    options.UseSqlServer(builder.Configuration.GetConnectionString("DefaultConnection")));

var app = builder.Build();

// Configure the HTTP request pipeline.
if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Home/Error");
}
app.UseStaticFiles();
app.UseRouting();
app.UseAuthorization();

app.MapControllerRoute(
    name: "default",
    pattern: "{controller=In}/{action=Index}/{id?}");

app.Run();


---

‚öôÔ∏è 5Ô∏è‚É£ Add Connection String

üóÇÔ∏è In your appsettings.json:

{
  "ConnectionStrings": {
    "DefaultConnection": "Server=YOUR_SERVER_NAME;Database=InventoryDB;Trusted_Connection=True;TrustServerCertificate=True;"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*"
}

üí° Replace YOUR_SERVER_NAME with your SQL Server name (e.g., localhost\\SQLEXPRESS).


---

üéÆ 6Ô∏è‚É£ Controller

üóÇÔ∏è Controllers/InController.cs

using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using InventoryInModule.Data;
using InventoryInModule.Models;

namespace InventoryInModule.Controllers
{
    public class InController : Controller
    {
        private readonly ApplicationDbContext _context;

        public InController(ApplicationDbContext context)
        {
            _context = context;
        }

        // List all transactions
        public IActionResult Index()
        {
            // Include category details when loading transactions
            var list = _context.InTransactions.Include(t => t.Category).ToList();
            return View(list);
        }

        // Show the Create form
        public IActionResult Create()
        {
            ViewBag.Categories = _context.Categories.ToList();
            return View();
        }

        // Save form data to database
        [HttpPost]
        public IActionResult Create(InTransaction transaction)
        {
            if (ModelState.IsValid)
            {
                _context.InTransactions.Add(transaction);
                _context.SaveChanges();
                return RedirectToAction("Index");
            }

            ViewBag.Categories = _context.Categories.ToList();
            return View(transaction);
        }
    }
}

üß† Explanation:

Index() ‚Üí loads all transactions with their category name.

Create() (GET) ‚Üí loads category dropdown.

Create() (POST) ‚Üí saves form data into the database.



---

üé® 7Ô∏è‚É£ Views

Views/In/Create.cshtml

@model InventoryInModule.Models.InTransaction
@using Microsoft.AspNetCore.Mvc.Rendering

<h2>Add New Transaction</h2>

<form asp-action="Create" method="post">
    <div class="form-group mb-3">
        <label>Item Name</label>
        <input asp-for="ItemName" class="form-control" />
    </div>

    <div class="form-group mb-3">
        <label>Quantity</label>
        <input asp-for="Quantity" class="form-control" />
    </div>

    <div class="form-group mb-3">
        <label>Category</label>
        <select asp-for="CategoryId" class="form-control"
                asp-items="@(new SelectList(ViewBag.Categories, "CategoryId", "CategoryName"))">
            <option value="">-- Select Category --</option>
        </select>
    </div>

    <button type="submit" class="btn btn-primary">Save</button>
</form>

<a asp-action="Index" class="btn btn-secondary mt-2">Back to List</a>


---

Views/In/Index.cshtml

@model IEnumerable<InventoryInModule.Models.InTransaction>

<h2>Transactions List</h2>

<table class="table table-bordered">
    <thead>
        <tr>
            <th>Item Name</th>
            <th>Quantity</th>
            <th>Category</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>@item.ItemName</td>
                <td>@item.Quantity</td>
                <td>@item.Category?.CategoryName</td>
            </tr>
        }
    </tbody>
</table>

<a asp-action="Create" class="btn btn-success">Add New</a>


---

‚öôÔ∏è 8Ô∏è‚É£ (Optional) Stored Procedure Version

If you prefer a stored procedure to insert data instead of EF .Add(),
create this in SQL:

CREATE PROCEDURE sp_AddInTransaction
    @ItemName NVARCHAR(100),
    @Quantity INT,
    @CategoryId INT
AS
BEGIN
    INSERT INTO tbl_intransactions (ItemName, Quantity, CategoryId)
    VALUES (@ItemName, @Quantity, @CategoryId)
END

Then modify your POST action:

[HttpPost]
public IActionResult Create(InTransaction transaction)
{
    if (ModelState.IsValid)
    {
        _context.Database.ExecuteSqlRaw(
            "EXEC sp_AddInTransaction @p0, @p1, @p2",
            transaction.ItemName, transaction.Quantity, transaction.CategoryId);

        return RedirectToAction("Index");
    }

    ViewBag.Categories = _context.Categories.ToList();
    return View(transaction);
}


---

üß† Summary for Beginners

Part	File	Purpose

Database	SQL Tables	Holds data for Categories & Transactions
Models	InTransaction.cs, Category.cs	Represent your tables
DbContext	ApplicationDbContext.cs	Manages database connection
Controller	InController.cs	Handles requests and logic
Views	Create.cshtml, Index.cshtml	User interface pages
Connection	Program.cs + appsettings.json	Tell EF where to connect



---

‚úÖ Once done, run your project:

dotnet run

Then open the URL it shows (e.g., https://localhost:5001/In).

You‚Äôll be able to:

Add new items with a category

View the list of all transactions with their category name



---

Would you like me to add Edit and Delete features next (with category dropdown also)?

** 0325

Perfect ‚Äî you‚Äôre now extending your In Module project to include a Category field!
Let‚Äôs go step-by-step and make sure everything is beginner-friendly and clear üß†

We‚Äôll:
1Ô∏è‚É£ Add a Category table in the database (tbl_category).
2Ô∏è‚É£ Create a Category model.
3Ô∏è‚É£ Update the InTransaction model to include a Category.
4Ô∏è‚É£ Modify the controller, view, and stored procedure to support it.
5Ô∏è‚É£ Add a simple textbox (or dropdown) to display categories.


---

üèóÔ∏è Step 1 ‚Äî Update the Database

Let‚Äôs say you have this SQL table:

CREATE TABLE tbl_category (
    CategoryId INT IDENTITY(1,1) PRIMARY KEY,
    CategoryName NVARCHAR(100)
);

INSERT INTO tbl_category (CategoryName)
VALUES ('Cables'), ('Connectors'), ('Switches');

This table will hold your Category list.


---

üìò Step 2 ‚Äî Create the Category Model

üóÇÔ∏è File: Models/Category.cs

namespace InventoryInModule.Models
{
    public class Category
    {
        public int CategoryId { get; set; }
        public string CategoryName { get; set; }
    }
}

üëâ This class represents your tbl_category table.


---

üìó Step 3 ‚Äî Update the ApplicationDbContext

üóÇÔ∏è File: Data/ApplicationDbContext.cs

using Microsoft.EntityFrameworkCore;
using InventoryInModule.Models;

namespace InventoryInModule.Data
{
    public class ApplicationDbContext : DbContext
    {
        public ApplicationDbContext(DbContextOptions<ApplicationDbContext> options)
            : base(options)
        {
        }

        public DbSet<InTransaction> InTransactions { get; set; }
        public DbSet<Category> Categories { get; set; }  // ‚úÖ Add this
    }
}

‚úÖ Now EF Core knows about both tables:

InTransactions

Categories



---

üìô Step 4 ‚Äî Update the InTransaction Model

üóÇÔ∏è File: Models/InTransaction.cs

using System.ComponentModel.DataAnnotations.Schema;

namespace InventoryInModule.Models
{
    public class InTransaction
    {
        public int Id { get; set; }
        public string ItemName { get; set; }
        public int Quantity { get; set; }

        // ‚úÖ Add Category Reference
        [ForeignKey("Category")]
        public int CategoryId { get; set; }
        public Category Category { get; set; }
    }
}

üëâ This tells EF Core that each transaction belongs to one Category.


---

üìò Step 5 ‚Äî Update the Controller

üóÇÔ∏è File: Controllers/InController.cs

We‚Äôll make sure the Create action can load categories into a dropdown or textbox.

using Microsoft.AspNetCore.Mvc;
using InventoryInModule.Data;
using InventoryInModule.Models;
using Microsoft.EntityFrameworkCore;

namespace InventoryInModule.Controllers
{
    public class InController : Controller
    {
        private readonly ApplicationDbContext _context;

        public InController(ApplicationDbContext context)
        {
            _context = context;
        }

        // GET: /In/Create
        public IActionResult Create()
        {
            // ‚úÖ Load categories from database
            ViewBag.Categories = _context.Categories.ToList();
            return View();
        }

        // POST: /In/Create
        [HttpPost]
        public IActionResult Create(InTransaction transaction)
        {
            if (ModelState.IsValid)
            {
                _context.InTransactions.Add(transaction);
                _context.SaveChanges();
                return RedirectToAction("Index");
            }

            // Reload categories if something fails
            ViewBag.Categories = _context.Categories.ToList();
            return View(transaction);
        }

        // List all transactions
        public IActionResult Index()
        {
            var list = _context.InTransactions.Include(t => t.Category).ToList();
            return View(list);
        }
    }
}


---

üßæ Step 6 ‚Äî Create or Update the View

üóÇÔ∏è File: Views/In/Create.cshtml

@model InventoryInModule.Models.InTransaction

<h2>Add New Transaction</h2>

<form asp-action="Create" method="post">
    <div class="form-group">
        <label>Item Name</label>
        <input asp-for="ItemName" class="form-control" />
    </div>

    <div class="form-group">
        <label>Quantity</label>
        <input asp-for="Quantity" class="form-control" />
    </div>

    <div class="form-group">
        <label>Category</label>
        <!-- ‚úÖ Dropdown populated from tbl_category -->
        <select asp-for="CategoryId" class="form-control" asp-items="@(new SelectList(ViewBag.Categories, "CategoryId", "CategoryName"))">
            <option value="">-- Select Category --</option>
        </select>
    </div>

    <button type="submit" class="btn btn-primary">Save</button>
</form>

üëâ When the page loads, the dropdown will automatically show all categories from the tbl_category table.


---

üíæ Step 7 ‚Äî Stored Procedure (Optional)

If you want to use a stored procedure for inserting instead of EF‚Äôs .Add(), you can do this in SQL:

CREATE PROCEDURE sp_AddInTransaction
    @ItemName NVARCHAR(100),
    @Quantity INT,
    @CategoryId INT
AS
BEGIN
    INSERT INTO tbl_intransactions (ItemName, Quantity, CategoryId)
    VALUES (@ItemName, @Quantity, @CategoryId)
END

Then modify your controller like:

_context.Database.ExecuteSqlRaw(
    "EXEC sp_AddInTransaction @p0, @p1, @p2",
    transaction.ItemName, transaction.Quantity, transaction.CategoryId);


---

üß† Step-by-Step Summary for Beginners

Step	Description	File / Command

1Ô∏è‚É£	Create tbl_category in SQL	SQL script
2Ô∏è‚É£	Create Category model	Models/Category.cs
3Ô∏è‚É£	Register in ApplicationDbContext	Data/ApplicationDbContext.cs
4Ô∏è‚É£	Add CategoryId to InTransaction	Models/InTransaction.cs
5Ô∏è‚É£	Load and save category in controller	Controllers/InController.cs
6Ô∏è‚É£	Add dropdown in Create view	Views/In/Create.cshtml
7Ô∏è‚É£	Optional: use stored procedure for insert	SQL + Controller



---

Would you like me to also show the Index View (Views/In/Index.cshtml) that lists all transactions with category name displayed?



** 0152

Perfect üëç ‚Äî let‚Äôs go step-by-step and explain everything clearly like a beginner-friendly tutorial.

We‚Äôll review the In Module project you just created using ASP.NET Core MVC + Entity Framework Core + Stored Procedure, and explain how each part works, why we use it, and how the data flows.


---

üß© PROJECT OVERVIEW

Goal:
To create a simple Inventory ‚ÄúIN Transaction‚Äù system where you can:

Input an item name and quantity

Save it to a database using a stored procedure

Use Entity Framework Core (EF Core) for the database connection



---

üß† WHAT HAPPENS BEHIND THE SCENES

Here‚Äôs the simple flow:

(View) Index.cshtml  ‚Üí  (Controller) InController.cs  ‚Üí  (Database) SQL Server via Stored Procedure

üßæ Step-by-step explanation:

1. The user types an Item Name and Quantity in the web form (View).


2. The Controller receives that data when the form is submitted.


3. The Controller uses Entity Framework Core to connect to the SQL Server.


4. The Controller executes a Stored Procedure that inserts the data into the database.


5. A success message is displayed to the user.




---

üß± STEP 1: The SQL Side

1Ô∏è‚É£ Create the Table and Stored Procedure

CREATE TABLE tblInTransactions (
    InID INT IDENTITY(1,1) PRIMARY KEY,
    ItemName NVARCHAR(100),
    Quantity INT,
    DateIn DATETIME DEFAULT GETDATE()
);
GO

CREATE PROCEDURE sp_InsertInTransaction
    @ItemName NVARCHAR(100),
    @Quantity INT
AS
BEGIN
    INSERT INTO tblInTransactions (ItemName, Quantity)
    VALUES (@ItemName, @Quantity);
END;
GO

üí¨ Explanation:

tblInTransactions ‚Üí your table to store incoming inventory.

sp_InsertInTransaction ‚Üí your stored procedure that inserts data into the table.

IDENTITY(1,1) ‚Üí automatically creates IDs like 1, 2, 3...

DEFAULT GETDATE() ‚Üí automatically stores the current date/time when inserting.



---

üß© STEP 2: The Model ‚Äî InTransaction.cs

using System;
using System.ComponentModel.DataAnnotations;

namespace InventoryInModule.Models
{
    public class InTransaction
    {
        [Key]                     // Marks InID as the primary key
        public int InID { get; set; }

        [Required]                // Must have a value (not null)
        [StringLength(100)]       // Max 100 characters
        public string ItemName { get; set; }

        [Required]                // Must have a value
        public int Quantity { get; set; }

        public DateTime DateIn { get; set; }  // Stores the date/time of transaction
    }
}

üí¨ Explanation:

This class represents your table structure in C#.

EF Core uses this model to understand what kind of data you‚Äôll store.

[Required] ensures the user must fill in those fields before saving.



---

üß± STEP 3: Database Context ‚Äî ApplicationDbContext.cs

using Microsoft.EntityFrameworkCore;
using InventoryInModule.Models;

namespace InventoryInModule.Data
{
    public class ApplicationDbContext : DbContext
    {
        // Constructor to accept options (like connection string)
        public ApplicationDbContext(DbContextOptions<ApplicationDbContext> options)
            : base(options)
        {
        }

        // Represent the table in code
        public DbSet<InTransaction> InTransactions { get; set; }
    }
}

üí¨ Explanation:

DbContext is a bridge between your code and your SQL database.

DbSet<InTransaction> represents the tblInTransactions table.

EF Core uses this to send and receive data from SQL Server.



---

‚öôÔ∏è STEP 4: Program.cs (Database Connection)

using InventoryInModule.Data;
using Microsoft.EntityFrameworkCore;

var builder = WebApplication.CreateBuilder(args);

// Add MVC services
builder.Services.AddControllersWithViews();

// Connect EF Core to SQL Server
builder.Services.AddDbContext<ApplicationDbContext>(options =>
    options.UseSqlServer(builder.Configuration.GetConnectionString("DefaultConnection")));

var app = builder.Build();

app.UseHttpsRedirection();
app.UseStaticFiles();
app.UseRouting();
app.UseAuthorization();

// Set default controller
app.MapControllerRoute(
    name: "default",
    pattern: "{controller=In}/{action=Index}/{id?}");

app.Run();

üí¨ Explanation:

Registers EF Core (ApplicationDbContext) so controllers can use it.

Reads connection string from appsettings.json.

Tells the app to start with InController and Index view by default.



---

üß± STEP 5: Controller ‚Äî InController.cs

using Microsoft.AspNetCore.Mvc;
using Microsoft.Data.SqlClient;
using Microsoft.EntityFrameworkCore;
using InventoryInModule.Data;
using InventoryInModule.Models;
using System.Threading.Tasks;

namespace InventoryInModule.Controllers
{
    public class InController : Controller
    {
        private readonly ApplicationDbContext _context;

        public InController(ApplicationDbContext context)
        {
            _context = context;   // injects database connection
        }

        public IActionResult Index()
        {
            return View();        // show the form
        }

        [HttpPost]
        public async Task<IActionResult> Index(InTransaction model)
        {
            if (ModelState.IsValid)
            {
                // Prepare parameters for stored procedure
                var itemNameParam = new SqlParameter("@ItemName", model.ItemName);
                var qtyParam = new SqlParameter("@Quantity", model.Quantity);

                // Execute the stored procedure
                await _context.Database.ExecuteSqlRawAsync(
                    "EXEC sp_InsertInTransaction @ItemName, @Quantity",
                    itemNameParam, qtyParam
                );

                ViewBag.Message = "Item successfully added!";
                ModelState.Clear(); // clears the form
            }

            return View();
        }
    }
}

üí¨ Explanation:

Index() (GET) ‚Üí Shows the input form.

Index() (POST) ‚Üí Handles the form submission.

ExecuteSqlRawAsync() ‚Üí Executes the stored procedure directly.

ViewBag.Message ‚Üí Sends success message to the View.



---

üé® STEP 6: View ‚Äî Views/In/Index.cshtml

@model InventoryInModule.Models.InTransaction
@{
    ViewData["Title"] = "In Module";
}

<div class="container mt-4">
    <h2>In Transaction Entry</h2>

    <form asp-action="Index" method="post" class="mt-3">
        <div class="mb-3">
            <label asp-for="ItemName" class="form-label"></label>
            <input asp-for="ItemName" class="form-control" required />
        </div>
        <div class="mb-3">
            <label asp-for="Quantity" class="form-label"></label>
            <input asp-for="Quantity" type="number" class="form-control" required />
        </div>
        <button type="submit" class="btn btn-primary">Save</button>
    </form>

    @if (ViewBag.Message != null)
    {
        <div class="alert alert-success mt-3">@ViewBag.Message</div>
    }
</div>

üí¨ Explanation:

The form sends data to InController when you click Save.

asp-for automatically binds form fields to the model (ItemName, Quantity).

After saving, it shows a success message.



---

üîÑ STEP 7: Data Flow Summary

Here‚Äôs the whole picture üëá

Step	Component	Action

1	User enters data	Fills in item name + quantity
2	View (Index.cshtml)	Sends data to Controller via POST
3	Controller (InController.cs)	Validates data, calls stored procedure
4	Database (sp_InsertInTransaction)	Inserts data into tblInTransactions
5	Controller	Sends success message back
6	View	Displays ‚ÄúItem successfully added!‚Äù



---

üß≠ STEP 8: Run and Test

1. Run the project:

dotnet run


2. Open your browser:

https://localhost:xxxx/In


3. Fill in:

Item Name: Cable
Quantity: 10


4. Click Save
‚úÖ Your data is inserted into SQL via stored procedure!




---

üí° Key Takeaways for Beginners

Concept	Meaning

MVC	Model-View-Controller ‚Äî separates logic, data, and UI.
Model	Represents your data (ItemName, Quantity).
Controller	Handles the logic and data flow between View and Model.
View	The user interface (HTML form).
EF Core	A tool that helps you talk to your database using C#.
Stored Procedure	A saved SQL command that runs in your database.
ApplicationDbContext	The class that connects EF Core to SQL Server.



---

Would you like me to add the next step ‚Äî a ‚ÄúView All Transactions‚Äù page using Entity Framework (no stored procedure) so you can list all the saved records in a table?



***

Perfect ‚Äî let‚Äôs level up your In Module project using ASP.NET Core MVC + Entity Framework Core + Stored Procedure ‚úÖ

We‚Äôll go step-by-step so you can run it easily in Visual Studio or VS Code.
The project will allow you to add an ‚ÄúIN Transaction‚Äù that saves to a SQL table using a stored procedure executed through EF Core.


---

üß© PROJECT OVERVIEW

üéØ Goal:

A simple Inventory In Module that:

Lets users input an item name and quantity.

Saves the data using a SQL stored procedure.

Uses Entity Framework Core for database access.



---

üß± STEP 1: Create SQL Table + Stored Procedure

In SQL Server Management Studio (SSMS), create a new database (e.g. InventoryDB) and run:

CREATE TABLE tblInTransactions (
    InID INT IDENTITY(1,1) PRIMARY KEY,
    ItemName NVARCHAR(100),
    Quantity INT,
    DateIn DATETIME DEFAULT GETDATE()
);
GO

CREATE PROCEDURE sp_InsertInTransaction
    @ItemName NVARCHAR(100),
    @Quantity INT
AS
BEGIN
    INSERT INTO tblInTransactions (ItemName, Quantity)
    VALUES (@ItemName, @Quantity);
END;
GO


---

‚öôÔ∏è STEP 2: Create ASP.NET Core MVC Project

In your terminal (Git Bash or PowerShell):

dotnet new mvc -n InventoryInModule
cd InventoryInModule

This creates an MVC project.


---

üß© STEP 3: Install Entity Framework Core SQL Server Provider

Run these commands inside the project folder:

dotnet add package Microsoft.EntityFrameworkCore
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools


---

‚öôÔ∏è STEP 4: Add Connection String

In appsettings.json:

{
  "ConnectionStrings": {
    "DefaultConnection": "Server=YOUR_SERVER;Database=InventoryDB;Trusted_Connection=True;TrustServerCertificate=True;"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*"
}

> üí° Replace YOUR_SERVER with your actual SQL Server name.




---

üß± STEP 5: Create the Model

File: Models/InTransaction.cs

using System;
using System.ComponentModel.DataAnnotations;

namespace InventoryInModule.Models
{
    public class InTransaction
    {
        [Key]
        public int InID { get; set; }

        [Required]
        [StringLength(100)]
        public string ItemName { get; set; }

        [Required]
        public int Quantity { get; set; }

        public DateTime DateIn { get; set; }
    }
}


---

üß± STEP 6: Create the Database Context

File: Data/ApplicationDbContext.cs

using Microsoft.EntityFrameworkCore;
using InventoryInModule.Models;

namespace InventoryInModule.Data
{
    public class ApplicationDbContext : DbContext
    {
        public ApplicationDbContext(DbContextOptions<ApplicationDbContext> options)
            : base(options)
        {
        }

        public DbSet<InTransaction> InTransactions { get; set; }
    }
}


---

üß© STEP 7: Register the Context in Program.cs

File: Program.cs

using InventoryInModule.Data;
using Microsoft.EntityFrameworkCore;

var builder = WebApplication.CreateBuilder(args);

// Add services to the container.
builder.Services.AddControllersWithViews();

// Register EF Core
builder.Services.AddDbContext<ApplicationDbContext>(options =>
    options.UseSqlServer(builder.Configuration.GetConnectionString("DefaultConnection")));

var app = builder.Build();

if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Home/Error");
    app.UseHsts();
}

app.UseHttpsRedirection();
app.UseStaticFiles();
app.UseRouting();
app.UseAuthorization();

app.MapControllerRoute(
    name: "default",
    pattern: "{controller=In}/{action=Index}/{id?}");

app.Run();


---

üß© STEP 8: Create Controller

File: Controllers/InController.cs

using Microsoft.AspNetCore.Mvc;
using Microsoft.Data.SqlClient;
using Microsoft.EntityFrameworkCore;
using InventoryInModule.Data;
using InventoryInModule.Models;
using System.Threading.Tasks;

namespace InventoryInModule.Controllers
{
    public class InController : Controller
    {
        private readonly ApplicationDbContext _context;

        public InController(ApplicationDbContext context)
        {
            _context = context;
        }

        public IActionResult Index()
        {
            return View();
        }

        [HttpPost]
        public async Task<IActionResult> Index(InTransaction model)
        {
            if (ModelState.IsValid)
            {
                var itemNameParam = new SqlParameter("@ItemName", model.ItemName);
                var qtyParam = new SqlParameter("@Quantity", model.Quantity);

                await _context.Database.ExecuteSqlRawAsync(
                    "EXEC sp_InsertInTransaction @ItemName, @Quantity",
                    itemNameParam, qtyParam
                );

                ViewBag.Message = "Item successfully added!";
                ModelState.Clear();
            }

            return View();
        }
    }
}


---

üé® STEP 9: Create View

File: Views/In/Index.cshtml

@model InventoryInModule.Models.InTransaction
@{
    ViewData["Title"] = "In Module";
}

<div class="container mt-4">
    <h2>In Transaction Entry</h2>

    <form asp-action="Index" method="post" class="mt-3">
        <div class="mb-3">
            <label asp-for="ItemName" class="form-label"></label>
            <input asp-for="ItemName" class="form-control" required />
        </div>
        <div class="mb-3">
            <label asp-for="Quantity" class="form-label"></label>
            <input asp-for="Quantity" type="number" class="form-control" required />
        </div>
        <button type="submit" class="btn btn-primary">Save</button>
    </form>

    @if (ViewBag.Message != null)
    {
        <div class="alert alert-success mt-3">@ViewBag.Message</div>
    }
</div>


---

üöÄ STEP 10: Run the Project

In terminal or Visual Studio:

dotnet run

Then open:

https://localhost:xxxx/In

Enter an item and quantity ‚Üí click Save ‚Üí
‚úÖ The stored procedure will run through Entity Framework Core and insert data into tblInTransactions.


---

‚úÖ SUMMARY

Component	Purpose

tblInTransactions	Database table
sp_InsertInTransaction	SQL stored procedure
InTransaction.cs	EF Core model
ApplicationDbContext.cs	EF Core DB context
InController.cs	Controller to call SP
Index.cshtml	Simple input view



---

Would you like me to extend this example next to include:

üîç Viewing all saved transactions (list page), or

üì¶ Dropdown for selecting item from an ‚ÄúItems‚Äù table?

***



Absolutely üëç Let‚Äôs create a simple ‚ÄúIN Module‚Äù project using ASP.NET Core MVC + SQL Server Stored Procedure ‚Äî step by step.

We‚Äôll build a small Inventory ‚ÄúIN Transaction‚Äù where users can record items being received into the system.


---

üß© PROJECT OVERVIEW

Goal: Create a page where the user can input an item and quantity, then save to the database via a stored procedure.

Example Table:

tblInTransactions

Column Name	Data Type	Description

InID	INT (PK, IDENTITY)	Auto-generated primary key
ItemName	NVARCHAR(100)	Name of item
Quantity	INT	Quantity received
DateIn	DATETIME	Transaction date



---

üõ†Ô∏è STEP 1: Create SQL Table & Stored Procedure

In SQL Server, run this:

CREATE TABLE tblInTransactions (
    InID INT IDENTITY(1,1) PRIMARY KEY,
    ItemName NVARCHAR(100),
    Quantity INT,
    DateIn DATETIME DEFAULT GETDATE()
);
GO

CREATE PROCEDURE sp_InsertInTransaction
    @ItemName NVARCHAR(100),
    @Quantity INT
AS
BEGIN
    INSERT INTO tblInTransactions (ItemName, Quantity)
    VALUES (@ItemName, @Quantity);
END;
GO


---

üñ•Ô∏è STEP 2: Create ASP.NET Core MVC Project

In Visual Studio or CLI:

dotnet new mvc -n InventoryInModule
cd InventoryInModule


---

‚öôÔ∏è STEP 3: Add Connection String

In appsettings.json:

{
  "ConnectionStrings": {
    "DefaultConnection": "Server=YOUR_SERVER;Database=InventoryDB;Trusted_Connection=True;TrustServerCertificate=True;"
  }
}


---

üß± STEP 4: Create Model

File: Models/InTransaction.cs

namespace InventoryInModule.Models
{
    public class InTransaction
    {
        public int InID { get; set; }
        public string ItemName { get; set; }
        public int Quantity { get; set; }
        public DateTime DateIn { get; set; }
    }
}


---

üß© STEP 5: Create Controller

File: Controllers/InController.cs

using Microsoft.AspNetCore.Mvc;
using Microsoft.Data.SqlClient;
using Microsoft.Extensions.Configuration;
using InventoryInModule.Models;
using System.Data;

namespace InventoryInModule.Controllers
{
    public class InController : Controller
    {
        private readonly IConfiguration _configuration;

        public InController(IConfiguration configuration)
        {
            _configuration = configuration;
        }

        public IActionResult Index()
        {
            return View();
        }

        [HttpPost]
        public IActionResult Index(InTransaction model)
        {
            if (ModelState.IsValid)
            {
                string connStr = _configuration.GetConnectionString("DefaultConnection");

                using (SqlConnection conn = new SqlConnection(connStr))
                {
                    using (SqlCommand cmd = new SqlCommand("sp_InsertInTransaction", conn))
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@ItemName", model.ItemName);
                        cmd.Parameters.AddWithValue("@Quantity", model.Quantity);
                        conn.Open();
                        cmd.ExecuteNonQuery();
                    }
                }

                ViewBag.Message = "Item successfully added!";
                ModelState.Clear();
            }

            return View();
        }
    }
}


---

üé® STEP 6: Create View

File: Views/In/Index.cshtml

@model InventoryInModule.Models.InTransaction
@{
    ViewData["Title"] = "In Module";
}

<h2>In Transaction Entry</h2>

<form asp-action="Index" method="post">
    <div class="form-group">
        <label>Item Name</label>
        <input asp-for="ItemName" class="form-control" required />
    </div>
    <div class="form-group">
        <label>Quantity</label>
        <input asp-for="Quantity" type="number" class="form-control" required />
    </div>
    <button type="submit" class="btn btn-primary mt-3">Save</button>
</form>

@if (ViewBag.Message != null)
{
    <div class="alert alert-success mt-3">@ViewBag.Message</div>
}


---

üöÄ STEP 7: Run the Project

Press F5 or run:

dotnet run

Navigate to:

https://localhost:xxxx/In

Try adding an item and quantity.
The record will be inserted into tblInTransactions via the stored procedure.



---

‚úÖ Summary

You‚Äôve created:

‚úÖ SQL Table + Stored Procedure

‚úÖ Model (InTransaction)

‚úÖ Controller (InController)

‚úÖ View (Index.cshtml)

‚úÖ Connected everything using ADO.NET



---

Would you like me to extend this example to include:

üîç Viewing all ‚ÄúIN‚Äù transactions (list page)

‚úèÔ∏è Editing or deleting records

üì¶ Integration with an Items table (lookup dropdown)?
