




Sub RunAllMacros()
    Call MacroA
    Call MacroB
    Call MacroC
    Call MacroD
    Call MacroE
    Call MacroF
    Call MacroG
    Call MacroH
    
End Sub

Sub MacroA()
    MsgBox "Æ’}Æ’NÆ’ÂAâ€šÃ°Å½Ã€Âsâ€™â€ "
'â€¢ÃÂâ€â€šÃ°â€”pË†Ã“â€šÂµâ€šÃœâ€šÂ·
    Dim srcWb As Workbook
    Dim srcWs As Worksheet
    Dim destWs As Worksheet
    Dim srcPath As String
    Dim srcLastRow As Long
    Dim destLastRow As Long
    Dim i As Long, j As Long
    Dim ÂÂ¤â€¢iâ€“Â¼ As String

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃŒÆ’pÆ’Xâ€šÃ°â€˜Iâ€˜Ã°
    With Application.FileDialog(msoFileDialogFilePicker)

        .Title = "â€œ]â€¹LÅ’Â³â€šÃŒÆ’uÆ’bÆ’Nâ€šÃ°â€˜Iâ€˜Ã°â€šÂµâ€šÃ„â€šÂ­â€šÂ¾â€šÂ³â€šÂ¢"
        .Filters.Add "ExcelÆ’tÆ’@Æ’CÆ’â€¹", "*.xls; *.xlsx; *.xlsm", 1
        If .Show <> -1 Then
            MsgBox "Æ’LÆ’Æ’Æ’â€œÆ’ZÆ’â€¹â€šÂ³â€šÃªâ€šÃœâ€šÂµâ€šÂ½ÂB"
            Exit Sub
        End If
        srcPath = .SelectedItems(1)
    End With

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃ°Å Jâ€šÂ­
    Set srcWb = Workbooks.Open(srcPath)
    Set srcWs = srcWb.Sheets("Row Data")

    ' â€œ]â€¹LÂÃ¦Æ’VÂ[Æ’gÂiâ€šÂ±â€šÃŒÆ’uÆ’bÆ’Nâ€šÃŒSheet1Âj
    Set destWs = ThisWorkbook.Sheets("Sheet1")

    ' ÂÃ…ÂIÂsÅ½Ã¦â€œÂ¾
    srcLastRow = srcWs.Cells(srcWs.Rows.Count, "I").End(xlUp).Row
    destLastRow = destWs.Cells(destWs.Rows.Count, "A").End(xlUp).Row

    ' â€œ]â€¹LÅ’Â³â€šÃŒBâ€”Ã±â€šÃ°Æ’â€¹Â[Æ’vÂiâ€¹Ã³â€”â€œâ€šÃ°ÂÅ“â€šÂ­Âj
    For j = 1 To srcLastRow
        ÂÂ¤â€¢iâ€“Â¼ = Trim(srcWs.Cells(j, "E").Value)
        If ÂÂ¤â€¢iâ€“Â¼ <> "" Then
            ' â€œ]â€¹LÂÃ¦â€šÃŒAâ€”Ã±â€šÃ°Æ’â€¹Â[Æ’vâ€šÂµâ€šÃ„Ë†Ãªâ€™vâ€šÃ°â€™Tâ€šÂ·
            For i = 14 To destLastRow
                If Trim(destWs.Cells(i, "AI").Value) = ÂÂ¤â€¢iâ€“Â¼ Then
                    ' Ë†Ãªâ€™vâ€šÂµâ€šÂ½â€šÃ§Câ€”Ã±â€šÃŒâ€™lâ€šÃ°Dâ€”Ã±â€šÃ‰â€œ]â€¹L
                    destWs.Cells(i, "AK").Value = srcWs.Cells(j, "X").Value
                End If
            Next i
        End If
    Next j

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃ°â€¢Ã‚â€šÂ¶â€šÃ©Âiâ€¢Ã›â€˜Â¶â€šÂ¹â€šÂ¸Âj
    'srcWb.Close SaveChanges:=False
End Sub

Sub MacroB()
    MsgBox "Æ’}Æ’NÆ’ÂBâ€šÃ°Å½Ã€Âsâ€™â€ "
'â€¢ÃÂâ€â€šÃ°â€”pË†Ã“â€šÂµâ€šÃœâ€šÂ·
    Dim srcWb As Workbook
    Dim srcWs As Worksheet
    Dim destWs As Worksheet
    Dim srcPath As String
    Dim srcLastRow As Long
    Dim destLastRow As Long
    Dim i As Long, j As Long
    Dim ÂÂ¤â€¢iâ€“Â¼ As String

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃŒÆ’pÆ’Xâ€šÃ°â€˜Iâ€˜Ã°
    With Application.FileDialog(msoFileDialogFilePicker)

        .Title = "â€œ]â€¹LÅ’Â³â€šÃŒÆ’uÆ’bÆ’Nâ€šÃ°â€˜Iâ€˜Ã°â€šÂµâ€šÃ„â€šÂ­â€šÂ¾â€šÂ³â€šÂ¢"
        .Filters.Add "ExcelÆ’tÆ’@Æ’CÆ’â€¹", "*.xls; *.xlsx; *.xlsm", 1
        If .Show <> -1 Then
            MsgBox "Æ’LÆ’Æ’Æ’â€œÆ’ZÆ’â€¹â€šÂ³â€šÃªâ€šÃœâ€šÂµâ€šÂ½ÂB"
            Exit Sub
        End If
        srcPath = .SelectedItems(1)
    End With

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃ°Å Jâ€šÂ­
    Set srcWb = Workbooks.Open(srcPath)
    Set srcWs = srcWb.Sheets("Row Data")

    ' â€œ]â€¹LÂÃ¦Æ’VÂ[Æ’gÂiâ€šÂ±â€šÃŒÆ’uÆ’bÆ’Nâ€šÃŒSheet1Âj
    Set destWs = ThisWorkbook.Sheets("Sheet1")

    ' ÂÃ…ÂIÂsÅ½Ã¦â€œÂ¾
    srcLastRow = srcWs.Cells(srcWs.Rows.Count, "I").End(xlUp).Row
    destLastRow = destWs.Cells(destWs.Rows.Count, "A").End(xlUp).Row

    ' â€œ]â€¹LÅ’Â³â€šÃŒBâ€”Ã±â€šÃ°Æ’â€¹Â[Æ’vÂiâ€¹Ã³â€”â€œâ€šÃ°ÂÅ“â€šÂ­Âj
    For j = 1 To srcLastRow
        ÂÂ¤â€¢iâ€“Â¼ = Trim(srcWs.Cells(j, "G").Value)
        If ÂÂ¤â€¢iâ€“Â¼ <> "" Then
            ' â€œ]â€¹LÂÃ¦â€šÃŒAâ€”Ã±â€šÃ°Æ’â€¹Â[Æ’vâ€šÂµâ€šÃ„Ë†Ãªâ€™vâ€šÃ°â€™Tâ€šÂ·
            For i = 14 To destLastRow
                If Trim(destWs.Cells(i, "AJ").Value) = ÂÂ¤â€¢iâ€“Â¼ Then
                    ' Ë†Ãªâ€™vâ€šÂµâ€šÂ½â€šÃ§Câ€”Ã±â€šÃŒâ€™lâ€šÃ°Dâ€”Ã±â€šÃ‰â€œ]â€¹L
                    destWs.Cells(i, "AK").Value = srcWs.Cells(j, "X").Value
                End If
            Next i
        End If
    Next j

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃ°â€¢Ã‚â€šÂ¶â€šÃ©Âiâ€¢Ã›â€˜Â¶â€šÂ¹â€šÂ¸Âj
    srcWb.Close SaveChanges:=False
End Sub

Sub MacroC()
'â€¢ÃÂâ€â€šÃ°â€”pË†Ã“â€šÂµâ€šÃœâ€šÂ·
    Dim WbTenkiMoto As Workbook
    Dim WsTenkiMoto As Worksheet
    Dim WsTenkiSaki As Worksheet
    Dim SearchValue As String
    Dim FindRng As Range
    Dim i As Long, lastRow As Long
    
    Dim SourceValueS As String
    Dim SourceValueT As String
    Dim S_Before As String, S_After As String
    Dim T_Before As String, T_After As String
    Dim CommaPosS As Long, CommaPosT As Long

    'â€œ]â€¹LÅ’Â³â€šÃŒÆ’uÆ’bÆ’Nâ€šÃ°Å Jâ€šÂ«â€šÃœâ€šÂ·(â€°Âºâ€¹Lâ€šÃŒÆ’tÆ’â€¹Æ’pÆ’Xâ€šÃâ€œ]â€¹LÅ’Â³â€šÃŒÆ’fÂ[Æ’^â€šÂªâ€šÂ â€šÃ©ÂÃªÂÅ â€šÃ°Å½wâ€™Ã¨â€šÂµâ€šÃ„â€šÂ­â€šÂ¾â€šÂ³â€šÂ¢)
    'Set WbTenkiMoto = Workbooks.Open("C:\Users\5011090\Desktop\â€°Ã¼â€˜PÅ Ë†â€œÂ®\Æ’gÆ’Å’Â[Æ’jÂ[â€°Ã¼â€˜PÅ Ë†â€œÂ®Ë†Ã„\Å’Å¸ÂÃ˜â€”pBlumeÆ’fÂ[Æ’^\Trial_Blume.xlsx")
    Set WbTenkiMoto = Workbooks.Open("D:\Trial_Blume.xlsx") ' For testing purposes only

    'â€œ]â€¹LÅ’Â³â€šÃ†â€œ]â€¹LÂÃ¦â€šÃŒÆ’VÂ[Æ’gâ€šÃ°Å½wâ€™Ã¨â€šÂµâ€šÃœâ€šÂ·
    Set WsTenkiMoto = WbTenkiMoto.Worksheets("Row Data")
    Set WsTenkiSaki = ThisWorkbook.Worksheets("Sheet1")

    'â€œ]â€¹LÂÃ¦â€šÃŒÂÃ…ÂIÂsâ€šÃ°Å½Ã¦â€œÂ¾â€šÂµâ€šÃœâ€šÂ·
    lastRow = WsTenkiSaki.Cells(Rows.Count, "A").End(xlUp).Row

    'â€œ]â€¹LÂÃ¦Æ’VÂ[Æ’gâ€šÃŒ2Âsâ€“Ãšâ€šÂ©â€šÃ§ÂÃ…ÂIÂsâ€šÃœâ€šÃ…â€šÃ°Æ’â€¹Â[Æ’vâ€šÂµâ€šÃœâ€šÂ·
    For i = 14 To lastRow
        
        'Å’Å¸ÂÃµâ€šÂ·â€šÃ©â€¢Â¶Å½Å¡â€šÃ°Å½wâ€™Ã¨â€šÂµâ€šÃœâ€šÂ·
        SearchValue = Trim(WsTenkiSaki.Cells(i, "AI").Value)
        
        If SearchValue <> "" Then ' Skip if the column AI is empty
        
            'â€œ]â€¹LÅ’Â³Æ’fÂ[Æ’^â€šÃŒÆ’VÂ[Æ’gâ€šÃŒBâ€”Ã±â€šÂ©â€šÃ§â€œÂ¯â€šÂ¶ÂÂ¤â€¢iâ€“Â¼â€šÃ°Å’Å¸ÂÃµâ€šÂµâ€šÃœâ€šÂ·(LookAt:=xlWhole = Å Â®â€˜SË†Ãªâ€™v)
            Set FindRng = WsTenkiMoto.Columns("E").Find(SearchValue, LookAt:=xlWhole)
            
            'â€œ]â€¹LÅ’Â³Æ’fÂ[Æ’^â€šÃŒBâ€”Ã±â€šÂ©â€šÃ§ÂÃ°Å’Ââ€šÃ‰Ë†Ãªâ€™vâ€šÂ·â€šÃ©â€™lâ€šÂªÅ’Â©â€šÃ‚â€šÂ©â€šÃâ€šÂ½ÂÃªÂâ€¡ÂAâ€°Â¿Å iâ€šÃ°â€œ]â€¹Lâ€šÂµâ€šÃœâ€šÂ·ÂiÅ’Â©â€šÃ‚â€šÂ©â€šÃ§â€šÃˆâ€šÂ©â€šÃâ€šÂ½ÂÃªÂâ€¡â€šÃÂAâ€°Â¿Å iâ€šÃŒÆ’ZÆ’â€¹â€šÃ°â€°Â©ÂFâ€šÃ…â€œhâ€šÃ¨â€šÃ‚â€šÃ”â€šÂµâ€šÃœâ€šÂ·Âj
            If Not FindRng Is Nothing Then
            
                ' Get values from Trial_Blume.xlsx columns S and T
                SourceValueS = Trim(WsTenkiMoto.Cells(FindRng.Row, "S").Value)
                SourceValueT = Trim(WsTenkiMoto.Cells(FindRng.Row, "T").Value)
                
                ' Find commas in both columns
                CommaPosS = InStr(1, SourceValueS, ",")
                CommaPosT = InStr(1, SourceValueT, ",")
                
                ' Check if column S contains a comma for the Vessel pattern.
                If CommaPosS = 0 Then
                    ' No comma in S
                    WsTenkiSaki.Cells(i, "AM").Value = SourceValueS & " " & SourceValueT
                    WsTenkiSaki.Cells(i, "AN").Value = "DIRECT"
                
                Else
                    ' Has comma in S (and likely in T)
                    
                    ' Split values before/after comma in S
                    S_Before = Trim(Left(SourceValueS, CommaPosS - 1))
                    S_After = Trim(Mid(SourceValueS, CommaPosS + 1))
                    
                    ' Split values before/after comma in T
                    If CommaPosT > 0 Then
                        T_Before = Trim(Left(SourceValueT, CommaPosT - 1))
                        T_After = Trim(Mid(SourceValueT, CommaPosT + 1))
                    Else
                        ' If T has no comma, use same T for both
                        T_Before = SourceValueT
                        T_After = SourceValueT
                    End If
                    
                    ' Combine the pairs
                    WsTenkiSaki.Cells(i, "AM").Value = S_Before & " " & T_Before
                    WsTenkiSaki.Cells(i, "AN").Value = S_After & " " & T_After
                End If
            
            Else
                WsTenkiSaki.Cells(i, "AM").Interior.Color = 0  'Å’Â©â€šÃ‚â€šÂ©â€šÃ§â€šÃˆâ€šÂ©â€šÃâ€šÂ½ÂÃªÂâ€¡
            End If
        End If
        
    Next i

    'Æ’Å Æ’\Â[Æ’Xâ€šÃ°Å Jâ€¢Ãºâ€šÂµâ€šÃœâ€šÂ·
    Set FindRng = Nothing
    Set WsTenkiMoto = Nothing
    Set WsTenkiSaki = Nothing
    Set WbTenkiMoto = Nothing

    ' Close workbook
    'WbTenkiMoto.Close SaveChanges:=False

End Sub

Sub MacroD()
'â€¢ÃÂâ€â€šÃ°â€”pË†Ã“â€šÂµâ€šÃœâ€šÂ·
    Dim WbTenkiMoto As Workbook
    Dim WsTenkiMoto As Worksheet
    Dim WsTenkiSaki As Worksheet
    Dim SearchValue As String
    Dim FindRng As Range
    Dim i As Long, lastRow As Long
    
    Dim SourceValueS As String
    Dim SourceValueT As String
    Dim S_Before As String, S_After As String
    Dim T_Before As String, T_After As String
    Dim CommaPosS As Long, CommaPosT As Long

    'â€œ]â€¹LÅ’Â³â€šÃŒÆ’uÆ’bÆ’Nâ€šÃ°Å Jâ€šÂ«â€šÃœâ€šÂ·(â€°Âºâ€¹Lâ€šÃŒÆ’tÆ’â€¹Æ’pÆ’Xâ€šÃâ€œ]â€¹LÅ’Â³â€šÃŒÆ’fÂ[Æ’^â€šÂªâ€šÂ â€šÃ©ÂÃªÂÅ â€šÃ°Å½wâ€™Ã¨â€šÂµâ€šÃ„â€šÂ­â€šÂ¾â€šÂ³â€šÂ¢)
    Set WbTenkiMoto = Workbooks.Open("C:\Users\5011090\Desktop\â€°Ã¼â€˜PÅ Ë†â€œÂ®\Æ’gÆ’Å’Â[Æ’jÂ[â€°Ã¼â€˜PÅ Ë†â€œÂ®Ë†Ã„\Å’Å¸ÂÃ˜â€”pBlumeÆ’fÂ[Æ’^\Trial_Blume.xlsx")
    'Set WbTenkiMoto = Workbooks.Open("D:\Trial_Blume.xlsx") ' For testing purposes only

    'â€œ]â€¹LÅ’Â³â€šÃ†â€œ]â€¹LÂÃ¦â€šÃŒÆ’VÂ[Æ’gâ€šÃ°Å½wâ€™Ã¨â€šÂµâ€šÃœâ€šÂ·
    Set WsTenkiMoto = WbTenkiMoto.Worksheets("Row Data")
    Set WsTenkiSaki = ThisWorkbook.Worksheets("Sheet1")

    'â€œ]â€¹LÂÃ¦â€šÃŒÂÃ…ÂIÂsâ€šÃ°Å½Ã¦â€œÂ¾â€šÂµâ€šÃœâ€šÂ·
    lastRow = WsTenkiSaki.Cells(Rows.Count, "A").End(xlUp).Row

    'â€œ]â€¹LÂÃ¦Æ’VÂ[Æ’gâ€šÃŒ2Âsâ€“Ãšâ€šÂ©â€šÃ§ÂÃ…ÂIÂsâ€šÃœâ€šÃ…â€šÃ°Æ’â€¹Â[Æ’vâ€šÂµâ€šÃœâ€šÂ·
    For i = 14 To lastRow
        
        'Å’Å¸ÂÃµâ€šÂ·â€šÃ©â€¢Â¶Å½Å¡â€šÃ°Å½wâ€™Ã¨â€šÂµâ€šÃœâ€šÂ·
        SearchValue = Trim(WsTenkiSaki.Cells(i, "AJ").Value)
        
        If SearchValue <> "" Then ' Skip if the column AI is empty
        
            'â€œ]â€¹LÅ’Â³Æ’fÂ[Æ’^â€šÃŒÆ’VÂ[Æ’gâ€šÃŒBâ€”Ã±â€šÂ©â€šÃ§â€œÂ¯â€šÂ¶ÂÂ¤â€¢iâ€“Â¼â€šÃ°Å’Å¸ÂÃµâ€šÂµâ€šÃœâ€šÂ·(LookAt:=xlWhole = Å Â®â€˜SË†Ãªâ€™v)
            Set FindRng = WsTenkiMoto.Columns("G").Find(SearchValue, LookAt:=xlWhole)
            
            'â€œ]â€¹LÅ’Â³Æ’fÂ[Æ’^â€šÃŒBâ€”Ã±â€šÂ©â€šÃ§ÂÃ°Å’Ââ€šÃ‰Ë†Ãªâ€™vâ€šÂ·â€šÃ©â€™lâ€šÂªÅ’Â©â€šÃ‚â€šÂ©â€šÃâ€šÂ½ÂÃªÂâ€¡ÂAâ€°Â¿Å iâ€šÃ°â€œ]â€¹Lâ€šÂµâ€šÃœâ€šÂ·ÂiÅ’Â©â€šÃ‚â€šÂ©â€šÃ§â€šÃˆâ€šÂ©â€šÃâ€šÂ½ÂÃªÂâ€¡â€šÃÂAâ€°Â¿Å iâ€šÃŒÆ’ZÆ’â€¹â€šÃ°â€°Â©ÂFâ€šÃ…â€œhâ€šÃ¨â€šÃ‚â€šÃ”â€šÂµâ€šÃœâ€šÂ·Âj
            If Not FindRng Is Nothing Then
            
                ' Get values from Trial_Blume.xlsx columns S and T
                SourceValueS = Trim(WsTenkiMoto.Cells(FindRng.Row, "S").Value)
                SourceValueT = Trim(WsTenkiMoto.Cells(FindRng.Row, "T").Value)
                
                ' Find commas in both columns
                CommaPosS = InStr(1, SourceValueS, ",")
                CommaPosT = InStr(1, SourceValueT, ",")
                
                ' Check if column S contains a comma for the Vessel pattern.
                If CommaPosS = 0 Then
                    ' No comma in S
                    WsTenkiSaki.Cells(i, "AM").Value = SourceValueS & " " & SourceValueT
                    WsTenkiSaki.Cells(i, "AN").Value = "DIRECT"
                
                Else
                    ' Has comma in S (and likely in T)
                    
                    ' Split values before/after comma in S
                    S_Before = Trim(Left(SourceValueS, CommaPosS - 1))
                    S_After = Trim(Mid(SourceValueS, CommaPosS + 1))
                    
                    ' Split values before/after comma in T
                    If CommaPosT > 0 Then
                        T_Before = Trim(Left(SourceValueT, CommaPosT - 1))
                        T_After = Trim(Mid(SourceValueT, CommaPosT + 1))
                    Else
                        ' If T has no comma, use same T for both
                        T_Before = SourceValueT
                        T_After = SourceValueT
                    End If
                    
                    ' Combine the pairs
                    WsTenkiSaki.Cells(i, "AM").Value = S_Before & " " & T_Before
                    WsTenkiSaki.Cells(i, "AN").Value = S_After & " " & T_After
                End If
            
            Else
                WsTenkiSaki.Cells(i, "AM").Interior.Color = 0  'Å’Â©â€šÃ‚â€šÂ©â€šÃ§â€šÃˆâ€šÂ©â€šÃâ€šÂ½ÂÃªÂâ€¡
            End If
        End If
        
    Next i

    'Æ’Å Æ’\Â[Æ’Xâ€šÃ°Å Jâ€¢Ãºâ€šÂµâ€šÃœâ€šÂ·
    Set FindRng = Nothing
    Set WsTenkiMoto = Nothing
    Set WsTenkiSaki = Nothing
    Set WbTenkiMoto = Nothing

    ' Close workbook
    'WbTenkiMoto.Close SaveChanges:=False

End Sub
Sub MacroE()
    MsgBox "Æ’}Æ’NÆ’ÂEâ€šÃ°Å½Ã€Âsâ€™â€ "
'â€¢ÃÂâ€â€šÃ°â€”pË†Ã“â€šÂµâ€šÃœâ€šÂ·
    Dim srcWb As Workbook
    Dim srcWs As Worksheet
    Dim destWs As Worksheet
    Dim srcPath As String
    Dim srcLastRow As Long
    Dim destLastRow As Long
    Dim i As Long, j As Long
    Dim ÂÂ¤â€¢iâ€“Â¼ As String

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃŒÆ’pÆ’Xâ€šÃ°â€˜Iâ€˜Ã°
    With Application.FileDialog(msoFileDialogFilePicker)

        .Title = "â€œ]â€¹LÅ’Â³â€šÃŒÆ’uÆ’bÆ’Nâ€šÃ°â€˜Iâ€˜Ã°â€šÂµâ€šÃ„â€šÂ­â€šÂ¾â€šÂ³â€šÂ¢"
        .Filters.Add "ExcelÆ’tÆ’@Æ’CÆ’â€¹", "*.xls; *.xlsx; *.xlsm", 1
        If .Show <> -1 Then
            MsgBox "Æ’LÆ’Æ’Æ’â€œÆ’ZÆ’â€¹â€šÂ³â€šÃªâ€šÃœâ€šÂµâ€šÂ½ÂB"
            Exit Sub
        End If
        srcPath = .SelectedItems(1)
    End With

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃ°Å Jâ€šÂ­
    Set srcWb = Workbooks.Open(srcPath)
    Set srcWs = srcWb.Sheets("Row Data")

    ' â€œ]â€¹LÂÃ¦Æ’VÂ[Æ’gÂiâ€šÂ±â€šÃŒÆ’uÆ’bÆ’Nâ€šÃŒSheet1Âj
    Set destWs = ThisWorkbook.Sheets("Sheet1")

    ' ÂÃ…ÂIÂsÅ½Ã¦â€œÂ¾
    srcLastRow = srcWs.Cells(srcWs.Rows.Count, "I").End(xlUp).Row
    destLastRow = destWs.Cells(destWs.Rows.Count, "A").End(xlUp).Row

    ' â€œ]â€¹LÅ’Â³â€šÃŒBâ€”Ã±â€šÃ°Æ’â€¹Â[Æ’vÂiâ€¹Ã³â€”â€œâ€šÃ°ÂÅ“â€šÂ­Âj
    For j = 1 To srcLastRow
        ÂÂ¤â€¢iâ€“Â¼ = Trim(srcWs.Cells(j, "G").Value)
        If ÂÂ¤â€¢iâ€“Â¼ <> "" Then
            ' â€œ]â€¹LÂÃ¦â€šÃŒAâ€”Ã±â€šÃ°Æ’â€¹Â[Æ’vâ€šÂµâ€šÃ„Ë†Ãªâ€™vâ€šÃ°â€™Tâ€šÂ·
            For i = 14 To destLastRow
                If Trim(destWs.Cells(i, "AJ").Value) = ÂÂ¤â€¢iâ€“Â¼ Then
                    ' Ë†Ãªâ€™vâ€šÂµâ€šÂ½â€šÃ§Câ€”Ã±â€šÃŒâ€™lâ€šÃ°Dâ€”Ã±â€šÃ‰â€œ]â€¹L
                    destWs.Cells(i, "AN").Value = srcWs.Cells(j, "S").Value
                End If
            Next i
        End If
    Next j

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃ°â€¢Ã‚â€šÂ¶â€šÃ©Âiâ€¢Ã›â€˜Â¶â€šÂ¹â€šÂ¸Âj
    srcWb.Close SaveChanges:=False
End Sub

Sub MacroF()
    MsgBox "Æ’}Æ’NÆ’ÂFâ€šÃ°Å½Ã€Âsâ€™â€ "
'â€¢ÃÂâ€â€šÃ°â€”pË†Ã“â€šÂµâ€šÃœâ€šÂ·
    Dim srcWb As Workbook
    Dim srcWs As Worksheet
    Dim destWs As Worksheet
    Dim srcPath As String
    Dim srcLastRow As Long
    Dim destLastRow As Long
    Dim i As Long, j As Long
    Dim ÂÂ¤â€¢iâ€“Â¼ As String

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃŒÆ’pÆ’Xâ€šÃ°â€˜Iâ€˜Ã°
    With Application.FileDialog(msoFileDialogFilePicker)

        .Title = "â€œ]â€¹LÅ’Â³â€šÃŒÆ’uÆ’bÆ’Nâ€šÃ°â€˜Iâ€˜Ã°â€šÂµâ€šÃ„â€šÂ­â€šÂ¾â€šÂ³â€šÂ¢"
        .Filters.Add "ExcelÆ’tÆ’@Æ’CÆ’â€¹", "*.xls; *.xlsx; *.xlsm", 1
        If .Show <> -1 Then
            MsgBox "Æ’LÆ’Æ’Æ’â€œÆ’ZÆ’â€¹â€šÂ³â€šÃªâ€šÃœâ€šÂµâ€šÂ½ÂB"
            Exit Sub
        End If
        srcPath = .SelectedItems(1)
    End With

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃ°Å Jâ€šÂ­
    Set srcWb = Workbooks.Open(srcPath)
    Set srcWs = srcWb.Sheets("Row Data")

    ' â€œ]â€¹LÂÃ¦Æ’VÂ[Æ’gÂiâ€šÂ±â€šÃŒÆ’uÆ’bÆ’Nâ€šÃŒSheet1Âj
    Set destWs = ThisWorkbook.Sheets("Sheet1")

    ' ÂÃ…ÂIÂsÅ½Ã¦â€œÂ¾
    srcLastRow = srcWs.Cells(srcWs.Rows.Count, "I").End(xlUp).Row
    destLastRow = destWs.Cells(destWs.Rows.Count, "A").End(xlUp).Row

    ' â€œ]â€¹LÅ’Â³â€šÃŒBâ€”Ã±â€šÃ°Æ’â€¹Â[Æ’vÂiâ€¹Ã³â€”â€œâ€šÃ°ÂÅ“â€šÂ­Âj
    For j = 1 To srcLastRow
        ÂÂ¤â€¢iâ€“Â¼ = Trim(srcWs.Cells(j, "E").Value)
        If ÂÂ¤â€¢iâ€“Â¼ <> "" Then
            ' â€œ]â€¹LÂÃ¦â€šÃŒAâ€”Ã±â€šÃ°Æ’â€¹Â[Æ’vâ€šÂµâ€šÃ„Ë†Ãªâ€™vâ€šÃ°â€™Tâ€šÂ·
            For i = 14 To destLastRow
                If Trim(destWs.Cells(i, "AI").Value) = ÂÂ¤â€¢iâ€“Â¼ Then
                    ' Ë†Ãªâ€™vâ€šÂµâ€šÂ½â€šÃ§Câ€”Ã±â€šÃŒâ€™lâ€šÃ°Dâ€”Ã±â€šÃ‰â€œ]â€¹L
                    destWs.Cells(i, "AQ").Value = srcWs.Cells(j, "AC").Value
                End If
            Next i
        End If
    Next j

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃ°â€¢Ã‚â€šÂ¶â€šÃ©Âiâ€¢Ã›â€˜Â¶â€šÂ¹â€šÂ¸Âj
    srcWb.Close SaveChanges:=False
End Sub

    
Sub MacroG()
    MsgBox "Æ’}Æ’NÆ’ÂGâ€šÃ°Å½Ã€Âsâ€™â€ "
'â€¢ÃÂâ€â€šÃ°â€”pË†Ã“â€šÂµâ€šÃœâ€šÂ·
    Dim srcWb As Workbook
    Dim srcWs As Worksheet
    Dim destWs As Worksheet
    Dim srcPath As String
    Dim srcLastRow As Long
    Dim destLastRow As Long
    Dim i As Long, j As Long
    Dim ÂÂ¤â€¢iâ€“Â¼ As String

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃŒÆ’pÆ’Xâ€šÃ°â€˜Iâ€˜Ã°
    With Application.FileDialog(msoFileDialogFilePicker)

        .Title = "â€œ]â€¹LÅ’Â³â€šÃŒÆ’uÆ’bÆ’Nâ€šÃ°â€˜Iâ€˜Ã°â€šÂµâ€šÃ„â€šÂ­â€šÂ¾â€šÂ³â€šÂ¢"
        .Filters.Add "ExcelÆ’tÆ’@Æ’CÆ’â€¹", "*.xls; *.xlsx; *.xlsm", 1
        If .Show <> -1 Then
            MsgBox "Æ’LÆ’Æ’Æ’â€œÆ’ZÆ’â€¹â€šÂ³â€šÃªâ€šÃœâ€šÂµâ€šÂ½ÂB"
            Exit Sub
        End If
        srcPath = .SelectedItems(1)
    End With

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃ°Å Jâ€šÂ­
    Set srcWb = Workbooks.Open(srcPath)
    Set srcWs = srcWb.Sheets("Row Data")

    ' â€œ]â€¹LÂÃ¦Æ’VÂ[Æ’gÂiâ€šÂ±â€šÃŒÆ’uÆ’bÆ’Nâ€šÃŒSheet1Âj
    Set destWs = ThisWorkbook.Sheets("Sheet1")

    ' ÂÃ…ÂIÂsÅ½Ã¦â€œÂ¾
    srcLastRow = srcWs.Cells(srcWs.Rows.Count, "I").End(xlUp).Row
    destLastRow = destWs.Cells(destWs.Rows.Count, "A").End(xlUp).Row

    ' â€œ]â€¹LÅ’Â³â€šÃŒBâ€”Ã±â€šÃ°Æ’â€¹Â[Æ’vÂiâ€¹Ã³â€”â€œâ€šÃ°ÂÅ“â€šÂ­Âj
    For j = 1 To srcLastRow
        ÂÂ¤â€¢iâ€“Â¼ = Trim(srcWs.Cells(j, "G").Value)
        If ÂÂ¤â€¢iâ€“Â¼ <> "" Then
            ' â€œ]â€¹LÂÃ¦â€šÃŒAâ€”Ã±â€šÃ°Æ’â€¹Â[Æ’vâ€šÂµâ€šÃ„Ë†Ãªâ€™vâ€šÃ°â€™Tâ€šÂ·
            For i = 14 To destLastRow
                If Trim(destWs.Cells(i, "AJ").Value) = ÂÂ¤â€¢iâ€“Â¼ Then
                    ' Ë†Ãªâ€™vâ€šÂµâ€šÂ½â€šÃ§Câ€”Ã±â€šÃŒâ€™lâ€šÃ°Dâ€”Ã±â€šÃ‰â€œ]â€¹L
                    destWs.Cells(i, "AQ").Value = srcWs.Cells(j, "AC").Value
                End If
            Next i
        End If
    Next j

    ' â€œ]â€¹LÅ’Â³Æ’uÆ’bÆ’Nâ€šÃ°â€¢Ã‚â€šÂ¶â€šÃ©Âiâ€¢Ã›â€˜Â¶â€šÂ¹â€šÂ¸Âj
    srcWb.Close SaveChanges:=False
End Sub

Sub MacroH()
    MsgBox "Æ’}Æ’NÆ’ÂHâ€šÃ°Å½Ã€Âsâ€™â€ "
'â€¢ÃÂâ€â€šÃ°â€”pË†Ã“â€šÂµâ€šÃœâ€šÂ·
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim akDate As Date
    Dim kDate As Date
    Dim kWeekEnd As Date
    Dim nextWeekWednesday As Date

    Set ws = ThisWorkbook.Sheets("Sheet1") ' Æ’VÂ[Æ’gâ€“Â¼â€šÃ°â€œKâ€¹Xâ€¢ÃÂXâ€šÂµâ€šÃ„â€šÂ­â€šÂ¾â€šÂ³â€šÂ¢
    lastRow = ws.Cells(ws.Rows.Count, "AK").End(xlUp).Row
    For i = 14 To lastRow ' Æ’wÆ’bÆ’_Â[â€šÂªâ€šÂ â€šÃ©ÂÃªÂâ€¡â€šÃ2â€šÂ©â€šÃ§Å JÅ½n
        If IsDate(ws.Cells(i, "AK").Value) And IsDate(ws.Cells(i, "K").Value) Then
        'If IsDate(ws.Cells(i, "K").Value) And IsDate(ws.Cells(i, "AK").Value) Then
            akDate = ws.Cells(i, "AK").Value
            kDate = ws.Cells(i, "K").Value

            ' Kâ€”Ã±â€šÃŒÂTâ€šÃŒÂÃ…ÂIâ€œÃºÂiâ€œÃºâ€”jâ€œÃºÂjâ€šÃ°Å’vÅ½Z
            kWeekEnd = kDate + 6
            ' AKâ€”Ã±â€šÃŒÂTâ€šÃŒâ€”â€šÂTâ€šÃŒÂâ€¦â€”jâ€œÃºâ€šÃ°Å’vÅ½Z
            nextWeekWednesday = akDate - Weekday(akDate, vbSunday) + 7 + 4

            If akDate > kWeekEnd And akDate >= nextWeekWednesday Then
                ws.Cells(i, "AX").Value = "A"
            Else
                ws.Cells(i, "AX").Value = "A" ' ÂÃ°Å’Ââ€šÃ‰Ââ€¡â€šÃ­â€šÃˆâ€šÂ¢ÂÃªÂâ€¡â€šÃâ€¹Ã³â€â€™Âiâ€CË†Ã“Âj
            End If
        End If
    Next i

    MsgBox "Æ’`Æ’FÆ’bÆ’NÅ Â®â€”Â¹â€šÂµâ€šÃœâ€šÂµâ€šÂ½ÂI", vbInformation

End Sub



Sub MarkCircleIfDateMatches()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim poDate As Date
    Dim checkDate As Date
    Dim targetWednesday As Date
    Dim i As Long

    Set ws = ThisWorkbook.Sheets("Sheet1") ' Change to your sheet name
    lastRow = ws.Cells(ws.Rows.Count, "K").End(xlUp).Row

    For i = 14 To lastRow ' Assuming row 1 is headers
        If IsDate(ws.Cells(i, "K").Value) And IsDate(ws.Cells(i, "AK").Value) Then
            poDate = ws.Cells(i, "K").Value
            checkDate = ws.Cells(i, "AK").Value

            ' Calculate Wednesday of the following week
            targetWednesday = poDate + 9 ' Monday + 9 days = next week's Wednesday

            If checkDate >= targetWednesday Then
                ws.Cells(i, "AX").Value = "O"
            Else
                ws.Cells(i, "AX").Value = "" ' Optional: clear if condition not met
            End If
        End If
    Next i
End Sub







-- 110325 0745

Sub CheckAndCopy_All_WithDateCheck()
    Dim wbThis As Workbook
    Dim wsThis As Worksheet
    Dim wbCompare As Workbook
    Dim wsCompare As Worksheet
    Dim fd As FileDialog
    Dim filePath As String
    Dim lastRowAI As Long, lastRowE As Long
    Dim cell As Range
    Dim val As Variant
    
    Dim dictG As Object, dictX As Object
    Dim dictS As Object, dictT As Object
    Dim dictAC As Object
    
    Dim SourceValueS As String, SourceValueT As String
    Dim CommaPosS As Long, CommaPosT As Long
    Dim S_Before As String, S_After As String
    Dim T_Before As String, T_After As String
    
    Dim poDate As Date, checkDate As Date, targetWednesday As Date
    
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Set wbThis = ThisWorkbook
    Set wsThis = wbThis.ActiveSheet
    
    '--- Open File Dialog
    Set fd = Application.FileDialog(msoFileDialogFilePicker)
    fd.Title = "Select file to compare (Columns E, G, X, S, T, AC)"
    fd.Filters.Clear
    fd.Filters.Add "Excel Files", "*.xls; *.xlsx; *.xlsm"
    
    If fd.Show <> -1 Then
        MsgBox "No file selected. Process cancelled.", vbInformation
        Exit Sub
    End If
    
    filePath = fd.SelectedItems(1)
    Set wbCompare = Workbooks.Open(filePath)
    Set wsCompare = wbCompare.Sheets(1) ' Adjust if needed
    
    '--- Create dictionaries for fast lookups
    Set dictG = CreateObject("Scripting.Dictionary")
    Set dictX = CreateObject("Scripting.Dictionary")
    Set dictS = CreateObject("Scripting.Dictionary")
    Set dictT = CreateObject("Scripting.Dictionary")
    Set dictAC = CreateObject("Scripting.Dictionary")
    
    lastRowE = wsCompare.Cells(wsCompare.Rows.Count, "E").End(xlUp).Row
    
    '--- Load all values from the selected file
    Dim key As Variant
    For Each cell In wsCompare.Range("E2:E" & lastRowE)
        If Not IsEmpty(cell.Value) Then
            key = Trim(cell.Value)
            dictG(key) = wsCompare.Cells(cell.Row, "G").Value
            dictX(key) = wsCompare.Cells(cell.Row, "X").Value
            dictS(key) = wsCompare.Cells(cell.Row, "S").Value
            dictT(key) = wsCompare.Cells(cell.Row, "T").Value
            dictAC(key) = wsCompare.Cells(cell.Row, "AC").Value
        End If
    Next cell
    
    '--- Compare AI in trial_wss1.xlsm
    lastRowAI = wsThis.Cells(wsThis.Rows.Count, "AI").End(xlUp).Row
    
    Dim i As Long
    For Each cell In wsThis.Range("AI2:AI" & lastRowAI)
        val = Trim(cell.Value)
        i = cell.Row
        
        If dictG.exists(val) Then
            ' Copy G â†’ AJ
            wsThis.Cells(i, "AJ").Value = dictG(val)
            
            ' Copy X â†’ AK
            wsThis.Cells(i, "AK").Value = dictX(val)
            
            ' Copy AC â†’ AQ
            wsThis.Cells(i, "AQ").Value = dictAC(val)
            
            ' --- Get and process S and T ---
            SourceValueS = Trim(dictS(val))
            SourceValueT = Trim(dictT(val))
            
            CommaPosS = InStr(1, SourceValueS, ",")
            CommaPosT = InStr(1, SourceValueT, ",")
            
            If CommaPosS = 0 Then
                ' No comma in S
                wsThis.Cells(i, "AM").Value = SourceValueS & " " & SourceValueT
                wsThis.Cells(i, "AN").Value = "DIRECT"
            Else
                ' Has comma in S
                S_Before = Trim(Left(SourceValueS, CommaPosS - 1))
                S_After = Trim(Mid(SourceValueS, CommaPosS + 1))
                
                If CommaPosT > 0 Then
                    T_Before = Trim(Left(SourceValueT, CommaPosT - 1))
                    T_After = Trim(Mid(SourceValueT, CommaPosT + 1))
                Else
                    T_Before = SourceValueT
                    T_After = SourceValueT
                End If
                
                wsThis.Cells(i, "AM").Value = S_Before & " " & T_Before
                wsThis.Cells(i, "AN").Value = S_After & " " & T_After
            End If
            
            ' --- New Logic: Check Dates in K and AK ---
            If IsDate(wsThis.Cells(i, "K").Value) And IsDate(wsThis.Cells(i, "AK").Value) Then
                poDate = wsThis.Cells(i, "K").Value
                checkDate = wsThis.Cells(i, "AK").Value
                
                ' Wednesday of the following week
                targetWednesday = poDate + 9
                
                If checkDate >= targetWednesday Then
                    wsThis.Cells(i, "AX").Value = "O"
                Else
                    wsThis.Cells(i, "AX").Value = "" ' Optional: clear if not met
                End If
            End If
            
        Else
            ' No match - optional clearing
            wsThis.Cells(i, "AJ").Value = ""
            wsThis.Cells(i, "AK").Value = ""
            wsThis.Cells(i, "AM").Value = ""
            wsThis.Cells(i, "AN").Value = ""
            wsThis.Cells(i, "AQ").Value = ""
            wsThis.Cells(i, "AX").Value = ""
        End If
    Next cell
    
    wbCompare.Close SaveChanges:=False
    
    MsgBox "Done! All columns copied and date logic applied.", vbInformation
    
    Application.ScreenUpdating = True
    Application.EnableEvents = True
End Sub


Booking Number	Equipment / Unit #
MNLF30353400	KKFU7963187
257814192	MRSU8598220
	MRSU8598220
257814192	
257814192	
	
257793538	
257793538	
257793538	MRSU7620170
	MRSU7620170
257793538	



If the date in column AK is on or after the Wednesday of the week following the PO WK in column K (which must always be a Monday here), enter 'â—‹' in column AX.





-- 1244

Sub CompareAndCopyData()
    Dim ws As Worksheet
    Dim wsSrc As Worksheet
    Dim wbSrc As Workbook
    Dim FilePath As Variant
    Dim lastRow As Long, lastRowSrc As Long
    Dim i As Long
    Dim FindRng As Range
    Dim SourceValueS As String, SourceValueT As String
    Dim CommaPosS As Long, CommaPosT As Long
    Dim S_Before As String, S_After As String
    Dim T_Before As String, T_After As String
    Dim poDate As Date, checkDate As Date, targetWednesday As Date
    Dim dayNum As Integer, daysToNextWednesday As Integer
    
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    ' Set your Trial_WSS1 sheet (edit if your sheet name differs)
    Set ws = ThisWorkbook.Sheets("Sheet1")
    
    ' Open File Dialog
    FilePath = Application.GetOpenFilename("Excel Files (*.xls*), *.xls*")
    If FilePath = False Then Exit Sub
    
    ' Open the selected workbook
    Set wbSrc = Workbooks.Open(FilePath)
    Set wsSrc = wbSrc.Sheets(1)
    
    lastRow = ws.Cells(ws.Rows.Count, "AI").End(xlUp).Row
    lastRowSrc = wsSrc.Cells(wsSrc.Rows.Count, "E").End(xlUp).Row
    
    For i = 2 To lastRow ' Assuming row 1 is header
        If ws.Cells(i, "AI").Value <> "" Then
            ' Search for match in source Column E
            Set FindRng = wsSrc.Range("E2:E" & lastRowSrc).Find(What:=ws.Cells(i, "AI").Value, LookIn:=xlValues, LookAt:=xlWhole)
            
            If Not FindRng Is Nothing Then
                ' Copy values if matched
                ws.Cells(i, "AJ").Value = wsSrc.Cells(FindRng.Row, "G").Value
                ws.Cells(i, "AK").Value = wsSrc.Cells(FindRng.Row, "X").Value
                ws.Cells(i, "AQ").Value = wsSrc.Cells(FindRng.Row, "AC").Value
                
                ' --- S and T Column Logic ---
                SourceValueS = Trim(wsSrc.Cells(FindRng.Row, "S").Value)
                SourceValueT = Trim(wsSrc.Cells(FindRng.Row, "T").Value)
                
                CommaPosS = InStr(1, SourceValueS, ",")
                CommaPosT = InStr(1, SourceValueT, ",")
                
                If CommaPosS = 0 Then
                    ws.Cells(i, "AM").Value = SourceValueS & " " & SourceValueT
                    ws.Cells(i, "AN").Value = "DIRECT"
                Else
                    S_Before = Trim(Left(SourceValueS, CommaPosS - 1))
                    S_After = Trim(Mid(SourceValueS, CommaPosS + 1))
                    
                    If CommaPosT > 0 Then
                        T_Before = Trim(Left(SourceValueT, CommaPosT - 1))
                        T_After = Trim(Mid(SourceValueT, CommaPosT + 1))
                    Else
                        T_Before = SourceValueT
                        T_After = SourceValueT
                    End If
                    
                    ws.Cells(i, "AM").Value = S_Before & " " & T_Before
                    ws.Cells(i, "AN").Value = S_After & " " & T_After
                End If
                
                ' --- Date Check Logic (Auto Next Week's Wednesday) ---
                If IsDate(ws.Cells(i, "K").Value) And IsDate(ws.Cells(i, "AK").Value) Then
                    poDate = ws.Cells(i, "K").Value
                    checkDate = ws.Cells(i, "AK").Value
                    
                    ' Determine weekday (1=Sunday ... 7=Saturday)
                    dayNum = Weekday(poDate, vbSunday)
                    
                    ' Calculate days to next week's Wednesday
                    daysToNextWednesday = ((4 - dayNum) + 7) Mod 7 + 7
                    targetWednesday = poDate + daysToNextWednesday
                    
                    ' Compare and mark result
                    If checkDate >= targetWednesday Then
                        ws.Cells(i, "AX").Value = "O"
                    Else
                        ws.Cells(i, "AX").ClearContents
                    End If
                End If
            Else
                ' No match â€” optional visual marker
                ws.Cells(i, "AM").Interior.Color = 0
            End If
        End If
    Next i
    
    wbSrc.Close SaveChanges:=False
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    
    MsgBox "Comparison and copy process completed.", vbInformation
End Sub



--1251

Perfect â€” excellent refinement ğŸ‘

You want the macro to skip copying column G â†’ AJ if AJ already has a value, while still continuing to copy the other columns (Xâ†’AK, ACâ†’AQ) and do all the other logic (S/T + Date checks).

Letâ€™s integrate that condition cleanly into the current macro logic âœ…


---

âœ… Updated Full Macro (Exact Match + â€œSkip if AJ already filledâ€)

This version keeps all your logic (exact matching, copy, S/T logic, auto-next-Wednesday logic), but now does not overwrite AJ if it already contains data.

Sub CompareAndCopyData()
    Dim ws As Worksheet
    Dim wsSrc As Worksheet
    Dim wbSrc As Workbook
    Dim FilePath As Variant
    Dim lastRow As Long, lastRowSrc As Long
    Dim i As Long
    Dim FindRng As Range
    Dim SourceValueS As String, SourceValueT As String
    Dim CommaPosS As Long, CommaPosT As Long
    Dim S_Before As String, S_After As String
    Dim T_Before As String, T_After As String
    Dim poDate As Date, checkDate As Date, targetWednesday As Date
    Dim dayNum As Integer, daysToNextWednesday As Integer
    
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    ' Set your Trial_WSS1 sheet (change if different)
    Set ws = ThisWorkbook.Sheets("Sheet1")
    
    ' Open File Dialog
    FilePath = Application.GetOpenFilename("Excel Files (*.xls*), *.xls*")
    If FilePath = False Then Exit Sub
    
    ' Open the selected workbook
    Set wbSrc = Workbooks.Open(FilePath)
    Set wsSrc = wbSrc.Sheets(1)
    
    lastRow = ws.Cells(ws.Rows.Count, "AI").End(xlUp).Row
    lastRowSrc = wsSrc.Cells(wsSrc.Rows.Count, "E").End(xlUp).Row
    
    For i = 2 To lastRow ' Assuming row 1 is header
        If ws.Cells(i, "AI").Value <> "" Then
            ' Search for exact match in source Column E
            Set FindRng = wsSrc.Range("E2:E" & lastRowSrc).Find(What:=ws.Cells(i, "AI").Value, LookIn:=xlValues, LookAt:=xlWhole)
            
            If Not FindRng Is Nothing Then
                ' --- Copy values if matched ---
                
                ' âœ… Skip copying if AJ already has a value
                If Trim(ws.Cells(i, "AJ").Value) = "" Then
                    ws.Cells(i, "AJ").Value = wsSrc.Cells(FindRng.Row, "G").Value
                End If
                
                ' Always update other columns
                ws.Cells(i, "AK").Value = wsSrc.Cells(FindRng.Row, "X").Value
                ws.Cells(i, "AQ").Value = wsSrc.Cells(FindRng.Row, "AC").Value
                
                ' --- S and T Column Logic ---
                SourceValueS = Trim(wsSrc.Cells(FindRng.Row, "S").Value)
                SourceValueT = Trim(wsSrc.Cells(FindRng.Row, "T").Value)
                
                CommaPosS = InStr(1, SourceValueS, ",")
                CommaPosT = InStr(1, SourceValueT, ",")
                
                If CommaPosS = 0 Then
                    ws.Cells(i, "AM").Value = SourceValueS & " " & SourceValueT
                    ws.Cells(i, "AN").Value = "DIRECT"
                Else
                    S_Before = Trim(Left(SourceValueS, CommaPosS - 1))
                    S_After = Trim(Mid(SourceValueS, CommaPosS + 1))
                    
                    If CommaPosT > 0 Then
                        T_Before = Trim(Left(SourceValueT, CommaPosT - 1))
                        T_After = Trim(Mid(SourceValueT, CommaPosT + 1))
                    Else
                        T_Before = SourceValueT
                        T_After = SourceValueT
                    End If
                    
                    ws.Cells(i, "AM").Value = S_Before & " " & T_Before
                    ws.Cells(i, "AN").Value = S_After & " " & T_After
                End If
                
                ' --- Date Check Logic (Auto Next Week's Wednesday) ---
                If IsDate(ws.Cells(i, "K").Value) And IsDate(ws.Cells(i, "AK").Value) Then
                    poDate = ws.Cells(i, "K").Value
                    checkDate = ws.Cells(i, "AK").Value
                    
                    dayNum = Weekday(poDate, vbSunday)
                    daysToNextWednesday = ((4 - dayNum) + 7) Mod 7 + 7
                    targetWednesday = poDate + daysToNextWednesday
                    
                    If checkDate >= targetWednesday Then
                        ws.Cells(i, "AX").Value = "O"
                    Else
                        ws.Cells(i, "AX").ClearContents
                    End If
                End If
            Else
                ws.Cells(i, "AM").Interior.Color = 0
            End If
        End If
    Next i
    
    wbSrc.Close SaveChanges:=False
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    
    MsgBox "Comparison and copy process completed.", vbInformation
End Sub


---

ğŸ” Whatâ€™s New

âœ… Conditional copy for AJ:

If Trim(ws.Cells(i, "AJ").Value) = "" Then
    ws.Cells(i, "AJ").Value = wsSrc.Cells(FindRng.Row, "G").Value
End If

This prevents overwriting existing values in AJ.

Other columns (AK, AQ, AM, AN, AX) still update normally.



---

Would you like me to now upgrade this macro to use a Scripting.Dictionary for much faster matching (especially if your source file has thousands of rows)?




---

If a cell in Column G is empty, look for the same value in Column E and copy the corresponding value from Column G where it's not empty.
