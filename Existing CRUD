Existing Create.cshtml:
@model WebApplication2.Models.Item
@{
    var categories = (IEnumerable<WebApplication2.Models.Category>)ViewBag.Categories;
}

<h2>Create Item</h2>

<form asp-action="Create">
    <div>
        <label>Item Name</label>
        <input asp-for="ItemName" class="form-control" />
    </div>
    @* <div>
        <label>Category</label>
        <input asp-for="Category" class="form-control" />
    </div> *@
    <div>
        <label>Category</label>
        <select asp-for="CategoryID" class="form-control"
                asp-items="@(new SelectList(ViewBag.Categories, "CategoryID", "CategoryName"))">
            <option value="">-- Select Category --</option>
        </select>
    </div>
    @* <div>
        <label>Quantity</label>
        <input asp-for="Quantity" class="form-control" />
    </div> *@
    <div class="form-group mt-2">
        <label>Quantity</label>
        <input asp-for="Quantity" class="form-control" id="Quantity" />
    </div>

    <div>
        <label>Location</label>
        <input asp-for="Status" class="form-control" />
    </div>
    <button type="submit" class="btn btn-primary mt-2">Save</button>
</form>


<!-- Add this JavaScript section -->
@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // Prepare category data (JSON from Razor)
        var categories = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(categories));

        $('#CategoryID').on('change', function () {
            var selectedId = $(this).val();
            var selectedCategory = categories.find(c => c.CategoryID == selectedId);

            if (selectedCategory) {
                if (selectedCategory.Uom.toLowerCase() === "pc") {
                    // Automatically fill Quantity field with category's default quantity
                    $('#Quantity').val(selectedCategory.Quantity);
                    $('#Quantity').prop('readonly', true);
                } else {
                    // Enable manual entry for non-"Pc" UoM
                    $('#Quantity').val('');
                    $('#Quantity').prop('readonly', false);
                }
            } else {
                $('#Quantity').val('');
                $('#Quantity').prop('readonly', false);
            }
        });
    </script>
}


Existing ItemController.cs
using Microsoft.AspNetCore.Mvc;
using Microsoft.Data.SqlClient;
using WebApplication2.Data;
using WebApplication2.Models;
using Microsoft.EntityFrameworkCore;

namespace WebApplication2.Controllers
{
    public class ItemController : Controller
    {
        private readonly ApplicationDbContext _context;

        public ItemController(ApplicationDbContext context)
        {
            _context = context;
        }

        // READ - List all items
        public async Task<IActionResult> Index()
        {
            var items = await _context.Items
                .FromSqlRaw("EXEC sp_GetAllItems")
                .ToListAsync();
            return View(items);
        }

        // CREATE - GET
        public IActionResult Create()
        {
            LoadCategories();
            return View();
        }

        // CREATE - POST
        [HttpPost]
        //public async Task<IActionResult> Create(Item item)
        //{
        //    if (ModelState.IsValid)
        //    {
        //        await _context.Database.ExecuteSqlRawAsync(
        //            "EXEC sp_InsertItem @ItemName, @CategoryID, @Quantity, @Status",
        //            new SqlParameter("@ItemName", item.ItemName),
        //            new SqlParameter("@CategoryID", item.CategoryID),
        //            new SqlParameter("@Quantity", item.Quantity),
        //            new SqlParameter("@Status", item.Status)
        //        );
        //        return RedirectToAction(nameof(Index));
        //    }
        //    LoadCategories();
        //    return View(item);
        //}
        [ValidateAntiForgeryToken]
        //public IActionResult Create(Item model)
        //{
        //    if (ModelState.IsValid)
        //    {
        //        // Get category to extract CategoryCode
        //        var category = _context.Categories
        //            .FirstOrDefault(c => c.CategoryID == model.CategoryID);

        //        if (category == null)
        //        {
        //            ModelState.AddModelError("", "Invalid Category.");
        //            LoadCategories();
        //            return View(model);
        //        }

        //        // Generate ControlNo
        //        model.ControlNo = GenerateControlNo(category.CategoryCode);

        //        // Save item via stored procedure
        //        var pName = new SqlParameter("@ItemName", model.ItemName);
        //        var pCategory = new SqlParameter("@CategoryID", model.CategoryID);
        //        var pQty = new SqlParameter("@Quantity", model.Quantity);
        //        var pStatus = new SqlParameter("@Status", model.Status);
        //        var pControl = new SqlParameter("@ControlNo", model.ControlNo);

        //        _context.Database.ExecuteSqlRaw(@"
        //    EXEC sp_InsertItem 
        //        @ItemName,
        //        @CategoryID,
        //        @Quantity,
        //        @Status,
        //        @ControlNo",
        //            pName, pCategory, pQty, pStatus, pControl
        //        );

        //        return RedirectToAction(nameof(Index));
        //    }

        //    LoadCategories();
        //    return View(model);
        //}

        public IActionResult Create(Item model)
        {
            if (ModelState.IsValid)
            {
                // 1. Get Category (to get validity months & prefix)
                var category = _context.Categories
                    .FirstOrDefault(c => c.CategoryID == model.CategoryID);

                if (category == null)
                {
                    ModelState.AddModelError("", "Invalid Category.");
                    LoadCategories();
                    return View(model);
                }

                // 2. Generate ControlNo
                model.ControlNo = GenerateControlNo(category.CategoryCode);

                // 3. Set Added Date (today)
                model.AddedDate = DateTime.Now;

                // 4. Compute Warranty Expiration Date
                model.WarrantyExpiration = model.AddedDate.AddMonths(category.ValidityMonths);

                // 5. Save via Stored Procedure
                var pName = new SqlParameter("@ItemName", model.ItemName);
                var pCat = new SqlParameter("@CategoryID", model.CategoryID);
                var pQty = new SqlParameter("@Quantity", model.Quantity);
                var pStatus = new SqlParameter("@Status", model.Status);
                var pCtrl = new SqlParameter("@ControlNo", model.ControlNo);
                var pDate = new SqlParameter("@AddedDate", model.AddedDate);
                var pExp = new SqlParameter("@WarrantyExpiration", model.WarrantyExpiration);

                _context.Database.ExecuteSqlRaw(@"
            EXEC sp_InsertItem 
                @ItemName,
                @CategoryID,
                @Quantity,
                @Status,
                @ControlNo,
                @AddedDate,
                @WarrantyExpiration",
                    pName, pCat, pQty, pStatus, pCtrl, pDate, pExp
                );

                return RedirectToAction(nameof(Index));
            }

            LoadCategories();
            return View(model);
        }


        // EDIT - GET
        public async Task<IActionResult> Edit(int id)
        {
            //    var item = await _context.Items
            //        .FromSqlRaw("EXEC sp_GetItemById @ItemID", new SqlParameter("@ItemID", id))
            //        .FirstOrDefaultAsync();
            var item = _context.Items
                  .FromSqlRaw("EXEC sp_GetItemById @ItemID", new SqlParameter("@ItemID", id))
                  .AsEnumerable()
                  .FirstOrDefault();

            if (item == null)
                return NotFound();

            LoadCategories();
            return View(item);
        }
        //public async Task<IActionResult> Edit(int id)
        //{
        //    //var item = await _context.Items
        //    //    .FromSqlRaw("EXEC sp_GetItemById @ItemID", new SqlParameter("@ItemID", id))
        //    //    .FirstOrDefaultAsync();
        //    var item = await Task.Run(() =>
        //        _context.Items
        //            .FromSqlRaw("EXEC sp_GetItemById @ItemID", new SqlParameter("@ItemID", id))
        //            .AsEnumerable()
        //            .FirstOrDefault()
        //    );

        //    if (item == null)
        //        return NotFound();

        //    return View(item);
        //}

        // EDIT - POST
        [HttpPost]
        public async Task<IActionResult> Edit(Item item)
        {
            if (ModelState.IsValid)
            {
                await _context.Database.ExecuteSqlRawAsync(
                    "EXEC sp_UpdateItem @ItemID, @ItemName, @CategoryID, @Quantity, @Status",
                    new SqlParameter("@ItemID", item.ItemID),
                    new SqlParameter("@ItemName", item.ItemName),
                    new SqlParameter("@CategoryID", item.CategoryID),
                    new SqlParameter("@Quantity", item.Quantity),
                    new SqlParameter("@Status", item.Status)
                );
                return RedirectToAction(nameof(Index));
            }
            return View(item);
        }

        // DELETE - GET
        public async Task<IActionResult> Delete(int id)
        {
            //var item = await _context.Items
            //    .FromSqlRaw("EXEC sp_GetItemById @ItemID", new SqlParameter("@ItemID", id))
            //    .FirstOrDefaultAsync();
            //var item = await Task.Run(() =>
            //    _context.Items
            //        .FromSqlRaw("EXEC sp_GetItemById @ItemID", new SqlParameter("@ItemID", id))
            //        .AsEnumerable()
            //        .FirstOrDefault()
            //);
            var item = _context.Items
                .FromSqlRaw("EXEC sp_GetItemById @ItemID", new SqlParameter("@ItemID", id))
                .AsEnumerable()
                .FirstOrDefault();

            if (item == null)
                return NotFound();

            return View(item);
        }

        // DELETE - POST
        [HttpPost, ActionName("Delete")]
        public async Task<IActionResult> DeleteConfirmed(int id)
        {
            await _context.Database.ExecuteSqlRawAsync(
                "EXEC sp_DeleteItem @ItemID",
                new SqlParameter("@ItemID", id)
            );
            return RedirectToAction(nameof(Index));
        }
        private void LoadCategories()
        {
            ViewBag.Categories = _context.Categories
                .FromSqlRaw("SELECT * FROM tbl_Category")
                .AsEnumerable()
                .ToList();
        }


        private string GenerateControlNo(string categoryCode)
        {
            string mmyy = DateTime.Now.ToString("MMyy");

            // call stored procedure to get current max seq
            var sqlCategoryCode = new SqlParameter("@CategoryCode", categoryCode);
            var sqlMMYY = new SqlParameter("@MMYY", mmyy);

            int maxSeq = _context.Database
                .SqlQueryRaw<int>("EXEC sp_GetMaxControlNoSeq @CategoryCode, @MMYY",
                    sqlCategoryCode, sqlMMYY)
                .AsEnumerable()
                .FirstOrDefault();

            int newSeq = maxSeq + 1;
            string seqFormatted = newSeq.ToString("000");

            return $"{categoryCode}-{mmyy}-{seqFormatted}";
        }




    }


}







**


Got it! I will add a table below the form that displays the existing items, so you can immediately see what is already in tbl_items after creating a new one.

This table will appear under your Create form, using Bootstrap styling.


---

âœ… Updated Create.cshtml with Table Below

@model WebApplication2.Models.Item
@{
    var categories = (IEnumerable<WebApplication2.Models.Category>)ViewBag.Categories;
    var items = (IEnumerable<WebApplication2.Models.Item>)ViewBag.Items;   // Add this
}

<h2>Create Item</h2>

<form asp-action="Create">
    <div>
        <label>Item Name</label>
        <input asp-for="ItemName" class="form-control" />
    </div>

    <div>
        <label>Category</label>
        <select asp-for="CategoryID" class="form-control"
                asp-items="@(new SelectList(ViewBag.Categories, "CategoryID", "CategoryName"))">
            <option value="">-- Select Category --</option>
        </select>
    </div>

    <div class="form-group mt-2">
        <label>Quantity</label>
        <input asp-for="Quantity" class="form-control" id="Quantity" />
    </div>

    <div>
        <label>Location</label>
        <input asp-for="Status" class="form-control" />
    </div>

    <button type="submit" class="btn btn-primary mt-2">Save</button>
</form>

<hr />

<h3>Existing Items</h3>

<table class="table table-bordered table-striped mt-3">
    <thead>
        <tr>
            <th>Item Name</th>
            <th>Category</th>
            <th>Quantity</th>
            <th>Status / Location</th>
        </tr>
    </thead>
    <tbody>
        @if (items != null && items.Any())
        {
            foreach (var item in items)
            {
                var cat = categories.FirstOrDefault(c => c.CategoryID == item.CategoryID);

                <tr>
                    <td>@item.ItemName</td>
                    <td>@cat?.CategoryName</td>
                    <td>@item.Quantity</td>
                    <td>@item.Status</td>
                </tr>
            }
        }
        else
        {
            <tr>
                <td colspan="4" class="text-center">No items found.</td>
            </tr>
        }
    </tbody>
</table>


@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        var categories = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(categories));

        $('#CategoryID').on('change', function () {
            var selectedId = $(this).val();
            var selectedCategory = categories.find(c => c.CategoryID == selectedId);

            if (selectedCategory) {
                if (selectedCategory.Uom.toLowerCase() === "pc") {
                    $('#Quantity').val(selectedCategory.Quantity);
                    $('#Quantity').prop('readonly', true);
                } else {
                    $('#Quantity').val('');
                    $('#Quantity').prop('readonly', false);
                }
            } else {
                $('#Quantity').val('');
                $('#Quantity').prop('readonly', false);
            }
        });
    </script>
}


---

âœ… Controller Update (Important)

Inside your ItemController â†’ Create GET, add:

public async Task<IActionResult> Create()
{
    ViewBag.Categories = await _context.Categories.ToListAsync();
    ViewBag.Items = await _context.Items.ToListAsync(); // Add this line
    return View();
}

After saving (POST), redirect back to Create:

[HttpPost]
public async Task<IActionResult> Create(Item item)
{
    if (ModelState.IsValid)
    {
        _context.Items.Add(item);
        await _context.SaveChangesAsync();
        return RedirectToAction("Create");
    }

    ViewBag.Categories = await _context.Categories.ToListAsync();
    ViewBag.Items = await _context.Items.ToListAsync();
    return View(item);
}


---

ðŸŽ‰ Result

After you save an item:

âœ” The form stays clean
âœ” The table below updates instantly
âœ” You can see all existing items (name, category, quantity, status/location)


---

If you want, I can also:

âœ… Add edit/delete buttons
âœ… Add DataTables search + pagination
âœ… Add category filter dropdown
Just tell me!


**


In my existing Create.cshtml code:

@model WebApplication2.Models.Item
@{
    var categories = (IEnumerable<WebApplication2.Models.Category>)ViewBag.Categories;
}

<h2>Create Item</h2>

<form asp-action="Create">
    <div>
        <label>Item Name</label>
        <input asp-for="ItemName" class="form-control" />
    </div>
    @* <div>
        <label>Category</label>
        <input asp-for="Category" class="form-control" />
    </div> *@
    <div>
        <label>Category</label>
        <select asp-for="CategoryID" class="form-control"
                asp-items="@(new SelectList(ViewBag.Categories, "CategoryID", "CategoryName"))">
            <option value="">-- Select Category --</option>
        </select>
    </div>
    @* <div>
        <label>Quantity</label>
        <input asp-for="Quantity" class="form-control" />
    </div> *@
    <div class="form-group mt-2">
        <label>Quantity</label>
        <input asp-for="Quantity" class="form-control" id="Quantity" />
    </div>

    <div>
        <label>Location</label>
        <input asp-for="Status" class="form-control" />
    </div>
    <button type="submit" class="btn btn-primary mt-2">Save</button>
</form>


<!-- Add this JavaScript section -->
@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // Prepare category data (JSON from Razor)
        var categories = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(categories));

        $('#CategoryID').on('change', function () {
            var selectedId = $(this).val();
            var selectedCategory = categories.find(c => c.CategoryID == selectedId);

            if (selectedCategory) {
                if (selectedCategory.Uom.toLowerCase() === "pc") {
                    // Automatically fill Quantity field with category's default quantity
                    $('#Quantity').val(selectedCategory.Quantity);
                    $('#Quantity').prop('readonly', true);
                } else {
                    // Enable manual entry for non-"Pc" UoM
                    $('#Quantity').val('');
                    $('#Quantity').prop('readonly', false);
                }
            } else {
                $('#Quantity').val('');
                $('#Quantity').prop('readonly', false);
            }
        });
    </script>
}

please add a table below fields
